(self["webpackJsonp_8496636c-2300-4915-abef-20de64c98d8b_1.20.0_"]=self["webpackJsonp_8496636c-2300-4915-abef-20de64c98d8b_1.20.0_"]||[]).push([[971],{7893:function(e){var t;"undefined"!=typeof self&&self,t=()=>(()=>{var e={933:(e,t)=>{"use strict";t.byteLength=function(e){var t=s(e),n=t[0],a=t[1];return 3*(n+a)/4-a},t.toByteArray=function(e){var t,n,r=s(e),o=r[0],c=r[1],d=new i(function(e,t,n){return 3*(t+n)/4-n}(0,o,c)),l=0,u=c>0?o-4:o;for(n=0;n<u;n+=4)t=a[e.charCodeAt(n)]<<18|a[e.charCodeAt(n+1)]<<12|a[e.charCodeAt(n+2)]<<6|a[e.charCodeAt(n+3)],d[l++]=t>>16&255,d[l++]=t>>8&255,d[l++]=255&t;return 2===c&&(t=a[e.charCodeAt(n)]<<2|a[e.charCodeAt(n+1)]>>4,d[l++]=255&t),1===c&&(t=a[e.charCodeAt(n)]<<10|a[e.charCodeAt(n+1)]<<4|a[e.charCodeAt(n+2)]>>2,d[l++]=t>>8&255,d[l++]=255&t),d},t.fromByteArray=function(e){for(var t,a=e.length,i=a%3,r=[],o=16383,s=0,c=a-i;s<c;s+=o)r.push(d(e,s,s+o>c?c:s+o));return 1===i?(t=e[a-1],r.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[a-2]<<8)+e[a-1],r.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")),r.join("")};for(var n=[],a=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0;o<64;++o)n[o]=r[o],a[r.charCodeAt(o)]=o;function s(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e){return n[e>>18&63]+n[e>>12&63]+n[e>>6&63]+n[63&e]}function d(e,t,n){for(var a,i=[],r=t;r<n;r+=3)a=(e[r]<<16&16711680)+(e[r+1]<<8&65280)+(255&e[r+2]),i.push(c(a));return i.join("")}a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63},46:(e,t,n)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let a=0,i=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(a++,"%c"===e&&(i=a))}),t.splice(i,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e={NODE_ENV:"production"}.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(601)(t);const{formatters:a}=e.exports;a.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},601:(e,t,n)=>{e.exports=function(e){function t(e){let n,i,r,o=null;function s(...e){if(!s.enabled)return;const a=s,i=Number(new Date),r=i-(n||i);a.diff=r,a.prev=n,a.curr=i,n=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let o=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(n,i)=>{if("%%"===n)return"%";o++;const r=t.formatters[i];if("function"==typeof r){const t=e[o];n=r.call(a,t),e.splice(o,1),o--}return n}),t.formatArgs.call(a,e),(a.log||t.log).apply(a,e)}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=a,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(i!==t.namespaces&&(i=t.namespaces,r=t.enabled(e)),r),set:e=>{o=e}}),"function"==typeof t.init&&t.init(s),s}function a(e,n){const a=t(this.namespace+(void 0===n?":":n)+e);return a.log=this.log,a}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(i),...t.skips.map(i).map(e=>"-"+e)].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const a=("string"==typeof e?e:"").split(/[\s,]+/),i=a.length;for(n=0;n<i;n++)a[n]&&("-"===(e=a[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,a;for(n=0,a=t.skips.length;n<a;n++)if(t.skips[n].test(e))return!1;for(n=0,a=t.names.length;n<a;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(821),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach(n=>{t[n]=e[n]}),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},821:e=>{var t=1e3,n=60*t,a=60*n,i=24*a;function r(e){if(!((e=String(e)).length>100)){var r=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(r){var o=parseFloat(r[1]);switch((r[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"weeks":case"week":case"w":return 6048e5*o;case"days":case"day":case"d":return o*i;case"hours":case"hour":case"hrs":case"hr":case"h":return o*a;case"minutes":case"minute":case"mins":case"min":case"m":return o*n;case"seconds":case"second":case"secs":case"sec":case"s":return o*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}}}function o(e){var r=Math.abs(e);return r>=i?Math.round(e/i)+"d":r>=a?Math.round(e/a)+"h":r>=n?Math.round(e/n)+"m":r>=t?Math.round(e/t)+"s":e+"ms"}function s(e){var r=Math.abs(e);return r>=i?c(e,r,i,"day"):r>=a?c(e,r,a,"hour"):r>=n?c(e,r,n,"minute"):r>=t?c(e,r,t,"second"):e+" ms"}function c(e,t,n,a){var i=t>=1.5*n;return Math.round(e/n)+" "+a+(i?"s":"")}e.exports=function(e,t){t=t||{};var n=typeof e;if("string"===n&&e.length>0)return r(e);if("number"===n&&isFinite(e))return t.long?s(e):o(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}}},t={};function n(a){var i=t[a];if(void 0!==i)return i.exports;var r=t[a]={exports:{}};return e[a](r,r.exports,n),r.exports}(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(a,i){if(1&i&&(a=this(a)),8&i)return a;if("object"==typeof a&&a){if(4&i&&a.__esModule)return a;if(16&i&&"function"==typeof a.then)return a}var r=Object.create(null);n.r(r);var o={};e=e||[null,t({}),t([]),t(t)];for(var s=2&i&&a;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach(e=>o[e]=()=>a[e]);return o.default=()=>a,n.d(r,o),r}})(),n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};return(()=>{"use strict";n.r(a),n.d(a,{ActionObjectType:()=>ne,ChannelType:()=>pe,ChildAppWindow:()=>ai,DialogDimension:()=>fe,ErrorCode:()=>ie,FileOpenPreference:()=>te,FrameContexts:()=>de,HostClientType:()=>se,HostName:()=>ce,LiveShareHost:()=>sr,NotificationTypes:()=>Kn,ParentAppWindow:()=>ii,SecondaryM365ContentIdName:()=>ae,TaskModuleDimension:()=>me,TeamType:()=>le,UserSettingTypes:()=>qn,UserTeamRole:()=>ue,ViewerActionTypes:()=>Wn,app:()=>kt,appEntity:()=>_a,appInitialization:()=>Oi,appInstallDialog:()=>Na,authentication:()=>ft,barCode:()=>Qa,calendar:()=>ui,call:()=>xi,chat:()=>Ya,clipboard:()=>Ja,conversations:()=>na,dialog:()=>gt,enablePrintCapability:()=>ki,executeDeepLink:()=>qi,externalAppAuthentication:()=>ia,externalAppCardActions:()=>ra,externalAppCommands:()=>oa,files:()=>ca,geoLocation:()=>ei,getAdaptiveCardSchemaVersion:()=>ti,getContext:()=>Pi,getMruTabInstances:()=>Ki,getTabInstances:()=>Gi,initialize:()=>Li,initializeWithFrameContext:()=>Yi,liveShare:()=>or,location:()=>oi,logs:()=>Gn,mail:()=>fi,marketplace:()=>hr,media:()=>za,meeting:()=>di,meetingRoom:()=>la,menus:()=>yt,messageChannels:()=>ct,monetization:()=>li,navigateBack:()=>er,navigateCrossDomain:()=>$i,navigateToTab:()=>Zi,nestedAppAuth:()=>Xa,notifications:()=>ua,openFilePreview:()=>ea,otherAppStateChange:()=>fa,pages:()=>Gt,people:()=>mi,print:()=>Mi,profile:()=>_i,registerAppButtonClickHandler:()=>Fi,registerAppButtonHoverEnterHandler:()=>Hi,registerAppButtonHoverLeaveHandler:()=>Ri,registerBackButtonHandler:()=>Ni,registerBeforeUnloadHandler:()=>ji,registerChangeSettingsHandler:()=>zi,registerCustomHandler:()=>Zn,registerFocusEnterHandler:()=>Vi,registerFullScreenHandler:()=>Ui,registerOnLoadHandler:()=>Bi,registerOnThemeChangeHandler:()=>Ti,registerUserSettingsChangeHandler:()=>$n,remoteCamera:()=>ma,returnFocus:()=>Xi,search:()=>bi,secondaryBrowser:()=>ri,sendCustomEvent:()=>Xn,sendCustomMessage:()=>Jn,setFrameContext:()=>Qi,settings:()=>nr,shareDeepLink:()=>Wi,sharing:()=>gi,stageView:()=>vi,tasks:()=>ir,teams:()=>ba,teamsCore:()=>pi,thirdPartyCloudStorage:()=>Ei,uploadCustomApp:()=>Yn,version:()=>qe,videoEffects:()=>xa,videoEffectsEx:()=>Ra,visualMedia:()=>Di,webStorage:()=>Ii});const e=(0,n(46).debug)("teamsJs");function t(t){return e.extend(t)}function i(e,t){return`${e}_${t}`}function r(e){return/^v\d+_[\w.]+$/.test(e)}const o=JSON.parse('{"validOrigins":["teams.microsoft.com","teams.microsoft.us","gov.teams.microsoft.us","dod.teams.microsoft.us","int.teams.microsoft.com","outlook.office.com","outlook-sdf.office.com","outlook.office365.com","outlook-sdf.office365.com","outlook.live.com","outlook-sdf.live.com","teams.live.com","local.teams.live.com","local.teams.live.com:8080","local.teams.office.com","local.teams.office.com:8080","devspaces.skype.com","*.www.office.com","www.office.com","word.office.com","excel.office.com","powerpoint.office.com","www.officeppe.com","*.www.microsoft365.com","www.microsoft365.com","bing.com","edgeservices.bing.com","www.bing.com","www.staging-bing-int.com","teams.cloud.microsoft","outlook.cloud.microsoft","m365.cloud.microsoft","copilot.microsoft.com","windows.msn.com","fa000000125.resources.office.net","fa000000129.resources.office.net","fa000000124.resources.office.net","fa000000128.resources.office.net"]}'),s="2.0.1",c="2.0.3",d="1.9.0",l="1.8.0",u=n.t(o,2).validOrigins,f=new URL("https://res.cdn.office.net/teams-js/validDomains/json/validDomains.json"),p=/^https:\/\//,m="https",_="teams.microsoft.com",h="The library has not yet been initialized";class b{}b.initializeCalled=!1,b.initializeCompleted=!1,b.additionalValidOrigins=[],b.initializePromise=void 0,b.isFramelessWindow=!1,b.frameContext=void 0,b.hostClientType=void 0,b.printCapabilityEnabled=!1;var g=n(933);const v=S,y=2147483647;function S(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return function(e){return function(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}(e),I(e<0?0:0|x(e))}(e)}return D(e,t,n)}function D(e,t,n){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!S.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=0|function(e,t){if(S.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||C(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length,a=arguments.length>2&&!0===arguments[2];if(!a&&0===n)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return O(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return w(e).length;default:if(i)return a?-1:O(e).length;t=(""+t).toLowerCase(),i=!0}}(e,t);let a=I(n);const i=a.write(e,t);return i!==n&&(a=a.slice(0,i)),a}(e,t);if(ArrayBuffer.isView(e))return function(e){if(C(e,Uint8Array)){const t=new Uint8Array(e);return A(t.buffer,t.byteOffset,t.byteLength)}return L(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(C(e,ArrayBuffer)||e&&C(e.buffer,ArrayBuffer))return A(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(C(e,SharedArrayBuffer)||e&&C(e.buffer,SharedArrayBuffer)))return A(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const a=e.valueOf&&e.valueOf();if(null!=a&&a!==e)return S.from(a,t,n);const i=function(e){if(S.isBuffer(e)){const t=0|x(e.length),n=I(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!=typeof e.length||K(e.length)?I(0):L(e):"Buffer"===e.type&&Array.isArray(e.data)?L(e.data):void 0}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return S.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function I(e){if(e>y)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,S.prototype),t}function x(e){if(e>=y)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+y.toString(16)+" bytes");return 0|e}function C(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function O(e,t){let n;t=t||1/0;const a=e.length;let i=null;const r=[];for(let o=0;o<a;++o){if(n=e.charCodeAt(o),n>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&r.push(239,191,189);continue}if(o+1===a){(t-=3)>-1&&r.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&r.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&r.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;r.push(n)}else if(n<2048){if((t-=2)<0)break;r.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;r.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;r.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return r}function w(e){return g.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(E,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}S.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),S.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required"),S.from=function(e,t,n){return D(e,t,n)},Object.setPrototypeOf(S.prototype,Uint8Array.prototype),Object.setPrototypeOf(S,Uint8Array),S.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},S.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==S.prototype};const E=/[^+/0-9A-Za-z-_]/g;function A(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let a;return a=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(a,S.prototype),a}function L(e){const t=e.length<0?0:0|x(e.length),n=I(t);for(let a=0;a<t;a+=1)n[a]=255&e[a];return n}function k(e,t,n){n=Math.min(e.length,n);const a=[];let i=t;for(;i<n;){const t=e[i];let r=null,o=t>239?4:t>223?3:t>191?2:1;if(i+o<=n){let n,a,s,c;switch(o){case 1:t<128&&(r=t);break;case 2:n=e[i+1],128==(192&n)&&(c=(31&t)<<6|63&n,c>127&&(r=c));break;case 3:n=e[i+1],a=e[i+2],128==(192&n)&&128==(192&a)&&(c=(15&t)<<12|(63&n)<<6|63&a,c>2047&&(c<55296||c>57343)&&(r=c));break;case 4:n=e[i+1],a=e[i+2],s=e[i+3],128==(192&n)&&128==(192&a)&&128==(192&s)&&(c=(15&t)<<18|(63&n)<<12|(63&a)<<6|63&s,c>65535&&c<1114112&&(r=c))}}null===r?(r=65533,o=1):r>65535&&(r-=65536,a.push(r>>>10&1023|55296),r=56320|1023&r),a.push(r),i+=o}return function(e){const t=e.length;if(t<=P)return String.fromCharCode.apply(String,e);let n="",a=0;for(;a<t;)n+=String.fromCharCode.apply(String,e.slice(a,a+=P));return n}(a)}function M(e,t,n){let a=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return T(this,t,n);case"utf8":case"utf-8":return k(this,t,n);case"ascii":return U(this,t,n);case"latin1":case"binary":return F(this,t,n);case"base64":return H(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,t,n);default:if(a)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),a=!0}}S.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?k(this,0,e):M.apply(this,arguments)};const P=4096;function T(e,t,n){const a=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>a)&&(n=a);let i="";for(let a=t;a<n;++a)i+=W[e[a]];return i}function U(e,t,n){let a="";n=Math.min(e.length,n);for(let i=t;i<n;++i)a+=String.fromCharCode(127&e[i]);return a}function F(e,t,n){let a="";n=Math.min(e.length,n);for(let i=t;i<n;++i)a+=String.fromCharCode(e[i]);return a}function H(e,t,n){return 0===t&&n===e.length?g.fromByteArray(e):g.fromByteArray(e.slice(t,n))}function R(e,t,n){const a=e.slice(t,n);let i="";for(let e=0;e<a.length-1;e+=2)i+=String.fromCharCode(a[e]+256*a[e+1]);return i}function N(e,t,n,a){n=Number(n)||0;const i=e.length-n;a?(a=Number(a))>i&&(a=i):a=i;const r=t.length;let o;for(a>r/2&&(a=r/2),o=0;o<a;++o){const a=parseInt(t.substr(2*o,2),16);if(K(a))return o;e[n+o]=a}return o}function B(e,t,n,a){return G(O(t,e.length-n),e,n,a)}function j(e,t,n,a){return G(function(e){const t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,a)}function V(e,t,n,a){return G(w(t),e,n,a)}function z(e,t,n,a){return G(function(e,t){let n,a,i;const r=[];for(let o=0;o<e.length&&!((t-=2)<0);++o)n=e.charCodeAt(o),a=n>>8,i=n%256,r.push(i),r.push(a);return r}(t,e.length-n),e,n,a)}function G(e,t,n,a){let i;for(i=0;i<a&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function K(e){return e!=e}S.prototype.write=function(e,t,n,a){if(void 0===t)a="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)a=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===a&&(a="utf8")):(a=n,n=void 0)}const i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");a||(a="utf8");let r=!1;for(;;)switch(a){case"hex":return N(this,e,t,n);case"utf8":case"utf-8":return B(this,e,t,n);case"ascii":case"latin1":case"binary":return j(this,e,t,n);case"base64":return V(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return z(this,e,t,n);default:if(r)throw new TypeError("Unknown encoding: "+a);a=(""+a).toLowerCase(),r=!0}};const W=function(){const e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){const a=16*n;for(let i=0;i<16;++i)t[a+i]=e[n]+e[i]}return t}(),q={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let Q;const Y=new Uint8Array(16);function J(){if(!Q&&(Q="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Q))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Q(Y)}const X=[];for(let e=0;e<256;++e)X.push((e+256).toString(16).slice(1));const Z=function(e,t,n){if(q.randomUUID&&!t&&!e)return q.randomUUID();const a=(e=e||{}).random||(e.rng||J)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=a[e];return t}return function(e,t=0){return X[e[t+0]]+X[e[t+1]]+X[e[t+2]]+X[e[t+3]]+"-"+X[e[t+4]]+X[e[t+5]]+"-"+X[e[t+6]]+X[e[t+7]]+"-"+X[e[t+8]]+X[e[t+9]]+"-"+X[e[t+10]]+X[e[t+11]]+X[e[t+12]]+X[e[t+13]]+X[e[t+14]]+X[e[t+15]]}(a)},$=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,ee=function(e){return"string"==typeof e&&$.test(e)};var te,ne,ae,ie,re,oe,se,ce,de,le,ue,fe;!function(e){e.Inline="inline",e.Desktop="desktop",e.Web="web"}(te||(te={})),function(e){e.M365Content="m365content"}(ne||(ne={})),function(e){e.DriveId="driveId",e.GroupId="groupId",e.SiteId="siteId",e.UserId="userId"}(ae||(ae={})),function(e){e[e.NOT_SUPPORTED_ON_PLATFORM=100]="NOT_SUPPORTED_ON_PLATFORM",e[e.INTERNAL_ERROR=500]="INTERNAL_ERROR",e[e.NOT_SUPPORTED_IN_CURRENT_CONTEXT=501]="NOT_SUPPORTED_IN_CURRENT_CONTEXT",e[e.PERMISSION_DENIED=1e3]="PERMISSION_DENIED",e[e.NETWORK_ERROR=2e3]="NETWORK_ERROR",e[e.NO_HW_SUPPORT=3e3]="NO_HW_SUPPORT",e[e.INVALID_ARGUMENTS=4e3]="INVALID_ARGUMENTS",e[e.UNAUTHORIZED_USER_OPERATION=5e3]="UNAUTHORIZED_USER_OPERATION",e[e.INSUFFICIENT_RESOURCES=6e3]="INSUFFICIENT_RESOURCES",e[e.THROTTLE=7e3]="THROTTLE",e[e.USER_ABORT=8e3]="USER_ABORT",e[e.OPERATION_TIMED_OUT=8001]="OPERATION_TIMED_OUT",e[e.OLD_PLATFORM=9e3]="OLD_PLATFORM",e[e.FILE_NOT_FOUND=404]="FILE_NOT_FOUND",e[e.SIZE_EXCEEDED=1e4]="SIZE_EXCEEDED"}(ie||(ie={})),function(e){e.GeoLocation="geolocation",e.Media="media"}(re||(re={})),function(e){e.TextPlain="text/plain",e.TextHtml="text/html",e.ImagePNG="image/png",e.ImageJPEG="image/jpeg"}(oe||(oe={})),function(e){e.desktop="desktop",e.web="web",e.android="android",e.ios="ios",e.ipados="ipados",e.macos="macos",e.rigel="rigel",e.surfaceHub="surfaceHub",e.teamsRoomsWindows="teamsRoomsWindows",e.teamsRoomsAndroid="teamsRoomsAndroid",e.teamsPhones="teamsPhones",e.teamsDisplays="teamsDisplays"}(se||(se={})),function(e){e.office="Office",e.outlook="Outlook",e.outlookWin32="OutlookWin32",e.orange="Orange",e.places="Places",e.teams="Teams",e.teamsModern="TeamsModern"}(ce||(ce={})),function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel",e.stage="stage",e.meetingStage="meetingStage"}(de||(de={})),function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff"}(le||(le={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(ue||(ue={})),function(e){e.Large="large",e.Medium="medium",e.Small="small"}(fe||(fe={}));var pe,me=fe;!function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"}(pe||(pe={}));const _e={errorCode:ie.NOT_SUPPORTED_ON_PLATFORM},he={adaptiveCardSchemaVersion:{majorVersion:1,minorVersion:5}},be=new Error("Invalid input count: Must supply a valid image count (limit of 10)."),ge=new Error("Invalid response: Received more images than the specified max limit in the response.");function ve(e){return(t,n)=>{if(!t)throw new Error(e||n)}}function ye(e,t){if("string"!=typeof e||"string"!=typeof t)return NaN;const n=e.split("."),a=t.split(".");function i(e){return/^\d+$/.test(e)}if(!n.every(i)||!a.every(i))return NaN;for(;n.length<a.length;)n.push("0");for(;a.length<n.length;)a.push("0");for(let e=0;e<n.length;++e)if(Number(n[e])!=Number(a[e]))return Number(n[e])>Number(a[e])?1:-1;return 0}function Se(){return Z()}function De(e){return Object.keys(e).forEach(t=>{"object"==typeof e[t]&&De(e[t])}),Object.freeze(e)}function Ie(e,t,...n){const a=e(...n);return a.then(()=>{t&&t(null)}).catch(e=>{t&&t(e)}),a}function xe(e){return!(ye(`${e.majorVersion}.${e.minorVersion}`,"1.5")>=0)}function Ce(e){return"https:"===e.protocol}function Oe(){if(we())throw new Error("window object undefined at SSR check");return window}function we(){return"undefined"==typeof window}function Ee(e,t){if(ke(e)||!function(e){return e.length<256&&e.length>4}(e)||!function(e){for(let t=0;t<e.length;t++){const n=e.charCodeAt(t);if(n<32||n>126)return!1}return!0}(e))throw t||new Error("id is not valid.")}function Ae(e,t){const n=e.toString().toLocaleLowerCase();if(ke(n))throw t||new Error("Invalid Url");if(n.length>2048)throw t||new Error("Url exceeds the maximum size of 2048 characters");if(!Ce(e))throw t||new Error("Url should be a valid https url")}function Le(e){const t=document.createElement("a");return t.href=e,new URL(t.href)}function ke(e){let t;try{const n=function(e){return new Map([["&lt;","<"],["&gt;",">"],["&amp;","&"],["&quot;",'"'],["&#39;","'"],["&#x2F;","/"]]).forEach((t,n)=>{e=e.replace(new RegExp(n,"gi"),t)}),e}(e);t=decodeURIComponent(n)}catch(n){t=e}return/<script[^>]*>[\s\S]*?<\/script[^>]*>/gi.test(t)}function Me(e){if(!e)throw new Error("id must not be empty");if(!1===ee(e))throw new Error("id must be a valid UUID")}const Pe=t("runtime");function Te(e){return 4===e.apiVersion}let Ue={apiVersion:-1,supports:{}};const Fe={apiVersion:4,isNAAChannelRecommended:!1,hostVersionsInfo:he,isLegacyTeams:!0,supports:{appInstallDialog:{},appEntity:{},call:{},chat:{},conversations:{},dialog:{card:{bot:{}},url:{bot:{},parentCommunication:{}},update:{}},interactive:{},logs:{},meetingRoom:{},menus:{},monetization:{},notifications:{},pages:{config:{},backStack:{},fullTrust:{}},remoteCamera:{},teams:{fullTrust:{}},teamsCore:{},video:{sharedFrame:{}}}},He=[se.desktop,se.web,se.rigel,se.surfaceHub,se.teamsRoomsWindows,se.teamsRoomsAndroid,se.teamsPhones,se.teamsDisplays],Re=[se.android,se.ios,se.ipados],Ne=[...He,...Re],Be=[{versionToUpgradeFrom:1,upgradeToNextVersion:e=>{var t;return{apiVersion:2,hostVersionsInfo:void 0,isLegacyTeams:e.isLegacyTeams,supports:Object.assign(Object.assign({},e.supports),{dialog:e.supports.dialog?{card:void 0,url:e.supports.dialog,update:null===(t=e.supports.dialog)||void 0===t?void 0:t.update}:void 0})}}},{versionToUpgradeFrom:2,upgradeToNextVersion:e=>{const t=e.supports,{appNotification:n}=t,a=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(t,["appNotification"]);return Object.assign(Object.assign({},e),{apiVersion:3,supports:a})}},{versionToUpgradeFrom:3,upgradeToNextVersion:e=>{var t,n,a,i,r;return{apiVersion:4,hostVersionsInfo:e.hostVersionsInfo,isNAAChannelRecommended:e.isNAAChannelRecommended,isLegacyTeams:e.isLegacyTeams,supports:Object.assign(Object.assign({},e.supports),{dialog:e.supports.dialog?{card:null===(t=e.supports.dialog)||void 0===t?void 0:t.card,url:{bot:null===(a=null===(n=e.supports.dialog)||void 0===n?void 0:n.url)||void 0===a?void 0:a.bot,parentCommunication:(null===(i=e.supports.dialog)||void 0===i?void 0:i.url)?{}:void 0},update:null===(r=e.supports.dialog)||void 0===r?void 0:r.update}:void 0})}}}],je={"1.0.0":[{capability:{pages:{appButton:{},tabs:{}},stageView:{}},hostClientTypes:He}],"1.9.0":[{capability:{location:{}},hostClientTypes:Ne}],"2.0.0":[{capability:{people:{}},hostClientTypes:Ne},{capability:{sharing:{}},hostClientTypes:[se.desktop,se.web]}],"2.0.1":[{capability:{teams:{fullTrust:{joinedTeams:{}}}},hostClientTypes:[se.android,se.desktop,se.ios,se.teamsRoomsAndroid,se.teamsPhones,se.teamsDisplays,se.web]},{capability:{webStorage:{}},hostClientTypes:[se.desktop]}],"2.0.5":[{capability:{webStorage:{}},hostClientTypes:[se.android,se.ios]}],"2.0.8":[{capability:{sharing:{}},hostClientTypes:[se.android,se.ios]}]},Ve=Pe.extend("generateBackCompatRuntimeConfig");function ze(e,t){const n=Object.assign({},e);for(const a in t)Object.prototype.hasOwnProperty.call(t,a)&&("object"!=typeof t[a]||Array.isArray(t[a])?a in e||(n[a]=t[a]):n[a]=ze(e[a]||{},t[a]));return n}function Ge(e,t,n){Ve("generating back compat runtime config for %s",e);let a=Object.assign({},t.supports);Ve("Supported capabilities in config before updating based on highestSupportedVersion: %o",a),Object.keys(n).forEach(t=>{ye(e,t)>=0&&n[t].forEach(e=>{void 0!==b.hostClientType&&e.hostClientTypes.includes(b.hostClientType)&&(a=ze(a,e.capability))})});const i={apiVersion:4,hostVersionsInfo:he,isLegacyTeams:!0,supports:a};return Ve("Runtime config after updating based on highestSupportedVersion: %o",i),i}const Ke=Pe.extend("applyRuntimeConfig");function We(e){"string"==typeof e.apiVersion&&(Ke("Trying to apply runtime with string apiVersion, processing as v1: %o",e),e=Object.assign(Object.assign({},e),{apiVersion:1})),Ke("Fast-forwarding runtime %o",e);const t=function(e){let t=e;if(t.apiVersion<4&&Be.forEach(e=>{t.apiVersion===e.versionToUpgradeFrom&&(t=e.upgradeToNextVersion(t))}),Te(t))return t;throw new Error("Received a runtime that could not be upgraded to the latest version")}(e);Ke("Applying runtime %o",t),Ue=De(t)}const qe="2.24.0",Qe=t("internal"),Ye=Qe.extend("ensureInitializeCalled"),Je=Qe.extend("ensureInitialized");function Xe(){if(!b.initializeCalled)throw Ye(h),new Error(h)}function Ze(e,...t){if(!b.initializeCompleted)throw Je("%s. initializeCalled: %s",h,b.initializeCalled.toString()),new Error(h);if(t&&t.length>0){let e=!1;for(let n=0;n<t.length;n++)if(t[n]===b.frameContext){e=!0;break}if(!e)throw new Error(`This call is only allowed in following contexts: ${JSON.stringify(t)}. Current context: "${b.frameContext}".`)}return function(e){if(Te(e))return!0;throw-1===e.apiVersion?new Error("The runtime has not yet been initialized"):new Error("The runtime version is not supported")}(e)}function $e(e=s){const t=ye(b.clientSupportedSDKVersion,e);return!isNaN(t)&&t>=0}function et(e=s){if(b.hostClientType!=se.android&&b.hostClientType!=se.ios&&b.hostClientType!=se.ipados)throw{errorCode:ie.NOT_SUPPORTED_ON_PLATFORM};if(!$e(e))throw{errorCode:ie.OLD_PLATFORM}}function tt(e){return null==e}var nt=function(e,t,n,a){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((a=a.apply(e,t||[])).next())})};let at=[];const it=t("validateOrigin");function rt(){return nt(this,void 0,void 0,function*(){yield ot()})}function ot(){return nt(this,void 0,void 0,function*(){return 0!==at.length?at:we()?(at=u,u):fetch(f).then(e=>{if(!e.ok)throw new Error("Invalid Response from Fetch Call");return e.json().then(e=>{if(function(e){let t=JSON.parse(e);try{t=JSON.parse(e)}catch(e){return!1}if(!t.validOrigins)return!1;for(const e of t.validOrigins)try{new URL("https://"+e)}catch(t){return it("isValidOriginsFromCDN call failed to validate origin: %s",e),!1}return!0}(JSON.stringify(e)))return at=e.validOrigins,at;throw new Error("Valid Origins List Is Invalid")})}).catch(e=>(it("validOrigins fetch call to CDN failed with error: %s. Defaulting to fallback list",e),at=u,at))})}function st(e,t){if("*."===e.substring(0,2)){const n=e.substring(1);if(t.length>n.length&&t.split(".").length===n.split(".").length&&t.substring(t.length-n.length)===n)return!0}else if(e===t)return!0;return!1}var ct,dt=function(e,t,n,a){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((a=a.apply(e,t||[])).next())})};!function(e){let n,a;!function(e){let n;const a=t("messageChannels.telemetry");function r(){var e;return!(!Ze(Ue)||!(null===(e=Ue.supports.messageChannels)||void 0===e?void 0:e.telemetry))}e.getTelemetryPort=function(){return dt(this,void 0,void 0,function*(){if(n)return a("Returning telemetry port from cache"),n;if(!r())throw _e;return n=yield gn(i("v1","messageChannels.telemetry.getTelemetryPort"),"messageChannels.telemetry.getTelemetryPort"),n})},e.isSupported=r,e._clearTelemetryPort=function(){n=void 0}}(n=e.telemetry||(e.telemetry={})),function(e){let n;const a=t("messageChannels.dataLayer");function r(){var e;return!(!Ze(Ue)||!(null===(e=Ue.supports.messageChannels)||void 0===e?void 0:e.dataLayer))}e.getDataLayerPort=function(){return dt(this,void 0,void 0,function*(){if(n)return a("Returning dataLayer port from cache"),n;if(!r())throw _e;return n=yield gn(i("v1","messageChannels.dataLayer.getDataLayerPort"),"messageChannels.dataLayer.getDataLayerPort"),n})},e.isSupported=r,e._clearDataLayerPort=function(){n=void 0}}(a=e.dataLayer||(e.dataLayer={})),e.isSupported=function(){return!(!Ze(Ue)||!Ue.supports.messageChannels)}}(ct||(ct={}));const lt="v1",ut="v2";var ft;!function(e){let t,n,a,r;function o(e,n){return new Promise((a,i)=>{if(b.hostClientType!==se.web){const t=Le(n.url);Ae(t),a(bn(e,"authentication.authenticate",[t.href,n.width,n.height,n.isExternal]).then(([e,t])=>{if(e)return t;throw new Error(t)}))}else t={success:a,fail:i},function(e){s();let t=e.width||600,n=e.height||400;t=Math.min(t,un.currentWindow.outerWidth-400),n=Math.min(n,un.currentWindow.outerHeight-200);const a=Le(e.url.replace("{oauthRedirectMethod}","web"));Ae(a);let i=void 0!==un.currentWindow.screenLeft?un.currentWindow.screenLeft:un.currentWindow.screenX,r=void 0!==un.currentWindow.screenTop?un.currentWindow.screenTop:un.currentWindow.screenY;i+=un.currentWindow.outerWidth/2-t/2,r+=un.currentWindow.outerHeight/2-n/2,un.childWindow=un.currentWindow.open(a.href,"_blank","toolbar=no, location=yes, status=no, menubar=no, scrollbars=yes, top="+r+", left="+i+", width="+t+", height="+n),un.childWindow?d():u("FailedToOpenWindow")}(n)})}function s(){c();try{un.childWindow&&un.childWindow.close()}finally{un.childWindow=null,un.childOrigin=null}}function c(){n&&(clearInterval(n),n=0),Jt("initialize"),Jt("navigateCrossDomain")}function d(){c(),n=un.currentWindow.setInterval(()=>{if(!un.childWindow||un.childWindow.closed)u("CancelledByUser");else{const e=un.childOrigin;try{un.childOrigin="*",zn("ping")}finally{un.childOrigin=e}}},100),Yt(i(lt,"authentication.authenticationWindow.registerInitializeHandler"),"initialize",()=>[de.authentication,b.hostClientType]),Yt(i(lt,"authentication.authenticationWindow.registerNavigateCrossDomainHandler"),"navigateCrossDomain",()=>!1)}function l(e){try{t&&t.success(e)}finally{t=void 0,s()}}function u(e){try{t&&t.fail(new Error(e))}finally{t=void 0,s()}}e.initialize=function(){Yt(i(lt,"authentication.registerAuthenticateSuccessHandler"),"authentication.authenticate.success",l,!1),Yt(i(lt,"authentication.registerAuthenticateFailureHandler"),"authentication.authenticate.failure",u,!1)},e.registerAuthenticationHandlers=function(e){a=e},e.authenticate=function(e){const t=void 0!==e,n=t?e:a;if(!n)throw new Error("No parameters are provided for authentication");return Ze(Ue,de.content,de.sidePanel,de.settings,de.remove,de.task,de.stage,de.meetingStage),o(n.successCallback||n.failureCallback?i(lt,"authentication.authenticate"):i(ut,"authentication.authenticate"),n).then(e=>{try{return n&&n.successCallback?(n.successCallback(e),""):e}finally{t||(a=void 0)}}).catch(e=>{try{if(n&&n.failureCallback)return n.failureCallback(e.message),"";throw e}finally{t||(a=void 0)}})},e.getAuthToken=function(e){return Xe(),function(e,t){return new Promise(n=>{n(bn(e,"authentication.getAuthToken",[null==t?void 0:t.resources,null==t?void 0:t.claims,null==t?void 0:t.silent,null==t?void 0:t.tenantId]))}).then(([e,t])=>{if(e)return t;throw new Error(t)})}(e&&(e.successCallback||e.failureCallback)?i(lt,"authentication.getAuthToken"):i(ut,"authentication.getAuthToken"),e).then(t=>e&&e.successCallback?(e.successCallback(t),""):t).catch(t=>{if(e&&e.failureCallback)return e.failureCallback(t.message),"";throw t})},e.getUser=function(e){return Xe(),function(e){return new Promise(t=>{t(bn(e,"authentication.getUser"))}).then(([e,t])=>{if(e)return t;throw new Error(t)})}(e&&(e.successCallback||e.failureCallback)?i(lt,"authentication.getUser"):i(ut,"authentication.getUser")).then(t=>e&&e.successCallback?(e.successCallback(t),null):t).catch(t=>{if(e&&e.failureCallback)return e.failureCallback(t.message),null;throw t})},e.notifySuccess=function(e,t){Ze(Ue,de.authentication),vn(i(t?lt:ut,"authentication.notifySuccess"),"authentication.authenticate.success",[e]),jn(un.parentWindow,()=>setTimeout(()=>un.currentWindow.close(),200))},e.notifyFailure=function(e,t){Ze(Ue,de.authentication),vn(i(t?lt:ut,"authentication.notifyFailure"),"authentication.authenticate.failure",[e]),jn(un.parentWindow,()=>setTimeout(()=>un.currentWindow.close(),200))},function(e){e.Public="public",e.EUDB="eudb",e.Other="other"}(r=e.DataResidency||(e.DataResidency={}))}(ft||(ft={}));const pt="v2";function mt(e,t){if(Ze(Ue,de.content,de.sidePanel,de.task,de.meetingStage),!gt.update.isSupported())throw _e;vn(e,"tasks.updateTask",[t])}function _t(e,t,n,a){if(Ze(Ue,de.content,de.sidePanel,de.meetingStage),!gt.url.isSupported())throw _e;a&&Yt(i(pt,"dialog.url.registerMessageForParentHandler"),"messageForParent",a),vn(e,"tasks.startTask",[gt.url.getDialogInfoFromUrlDialogInfo(t)],(e,t)=>{null==n||n({err:e,result:t}),Jt("messageForParent")})}function ht(e,t,n,a){if(Ze(Ue,de.content,de.sidePanel,de.meetingStage),!gt.url.bot.isSupported())throw _e;a&&Yt(i(pt,"dialog.url.bot.registerMessageForParentHandler"),"messageForParent",a),vn(e,"tasks.startTask",[gt.url.getDialogInfoFromBotUrlDialogInfo(t)],(e,t)=>{null==n||n({err:e,result:t}),Jt("messageForParent")})}function bt(e,t,n){if(Ze(Ue,de.content,de.task),!gt.url.isSupported())throw _e;vn(e,"tasks.completeTask",[t,n?Array.isArray(n)?n:[n]:[]])}var gt;!function(e){const t=[];function n(e){b.frameContext&&(b.frameContext===de.task?t.push(e):Jt("messageForChild"))}let a,r,o;e.initialize=function(){Yt(i(pt,"dialog.registerMessageForChildHandler"),"messageForChild",n,!1)},function(e){let n,a;function r(e){return{url:e.url,height:e.size?e.size.height:fe.Small,width:e.size?e.size.width:fe.Small,title:e.title,fallbackUrl:e.fallbackUrl}}e.open=function(e,t,n){_t(i(pt,"dialog.url.open"),e,t,n)},e.submit=function(e,t){bt(i(pt,"dialog.url.submit"),e,t)},function(e){function n(){var e,t;return Ze(Ue)&&!!(null===(t=null===(e=Ue.supports.dialog)||void 0===e?void 0:e.url)||void 0===t?void 0:t.parentCommunication)}e.sendMessageToParentFromDialog=function(e){if(Ze(Ue,de.task),!n())throw _e;vn(i(pt,"dialog.url.parentCommunication.sendMessageToParentFromDialog"),"messageForParent",[e])},e.sendMessageToDialog=function(e){if(Ze(Ue,de.content,de.sidePanel,de.meetingStage),!n())throw _e;vn(i(pt,"dialog.url.parentCommunication.sendMessageToDialog"),"messageForChild",[e])},e.registerOnMessageFromParent=function(e){if(Ze(Ue,de.task),!n())throw _e;for(Jt("messageForChild"),Yt(i(pt,"dialog.url.parentCommunication.registerMessageForChildHandler"),"messageForChild",e),t.reverse();t.length>0;)e(t.pop())},e.isSupported=n}(n=e.parentCommunication||(e.parentCommunication={})),e.isSupported=function(){return Ze(Ue)&&void 0!==(Ue.supports.dialog&&Ue.supports.dialog.url)},function(e){e.open=function(e,t,n){ht(i(pt,"dialog.url.bot.open"),e,t,n)},e.isSupported=function(){return Ze(Ue)&&void 0!==(Ue.supports.dialog&&Ue.supports.dialog.url&&Ue.supports.dialog.url.bot)}}(a=e.bot||(e.bot={})),e.getDialogInfoFromUrlDialogInfo=r,e.getDialogInfoFromBotUrlDialogInfo=function(e){const t=r(e);return t.completionBotId=e.completionBotId,t}}(a=e.url||(e.url={})),e.isSupported=function(){return!(!Ze(Ue)||!Ue.supports.dialog)},function(e){e.resize=function(e){mt(i(pt,"dialog.update.resize"),e)},e.isSupported=function(){return!(!Ze(Ue)||!Ue.supports.dialog||!Ue.supports.dialog.update)}}(r=e.update||(e.update={})),function(e){function t(){const e=Ue.hostVersionsInfo&&Ue.hostVersionsInfo.adaptiveCardSchemaVersion&&!xe(Ue.hostVersionsInfo.adaptiveCardSchemaVersion);return Ze(Ue)&&void 0!==(e&&Ue.supports.dialog&&Ue.supports.dialog.card)}let n;function a(e){return{card:e.card,height:e.size?e.size.height:fe.Small,width:e.size?e.size.width:fe.Small,title:e.title}}function r(e){const t=a(e);return t.completionBotId=e.completionBotId,t}e.open=function(e,n){if(Ze(Ue,de.content,de.sidePanel,de.meetingStage),!t())throw _e;const r=a(e);vn(i(pt,"dialog.adaptiveCard.open"),"tasks.startTask",[r],(e,t)=>{null==n||n({err:e,result:t})})},e.isSupported=t,function(e){function t(){const e=Ue.hostVersionsInfo&&Ue.hostVersionsInfo.adaptiveCardSchemaVersion&&!xe(Ue.hostVersionsInfo.adaptiveCardSchemaVersion);return Ze(Ue)&&void 0!==(e&&Ue.supports.dialog&&Ue.supports.dialog.card&&Ue.supports.dialog.card.bot)}e.open=function(e,n){if(Ze(Ue,de.content,de.sidePanel,de.meetingStage),!t())throw _e;const a=r(e);vn(i(pt,"dialog.adaptiveCard.bot.open"),"tasks.startTask",[a],(e,t)=>{null==n||n({err:e,result:t})})},e.isSupported=t}(n=e.bot||(e.bot={}))}(o=e.adaptiveCard||(e.adaptiveCard={}))}(gt||(gt={}));const vt="v2";var yt;!function(e){let t,n,a,r,o;function s(e){o&&o(e)||(Ze(Ue),vn(i(vt,"menus.handleViewConfigItemPress"),"viewConfigItemPress",[e]))}function c(e){a&&a(e)||(Ze(Ue),vn(i(vt,"menus.handleNavBarMenuItemPress"),"handleNavBarMenuItemPress",[e]))}function d(e){r&&r(e)||(Ze(Ue),vn(i(vt,"menus.handleActionMenuItemPress"),"handleActionMenuItemPress",[e]))}function l(){return!(!Ze(Ue)||!Ue.supports.menus)}!function(e){e[e.ifRoom=0]="ifRoom",e[e.overflowOnly=1]="overflowOnly"}(t=e.DisplayMode||(e.DisplayMode={})),e.MenuItem=class{constructor(){this.enabled=!0,this.selected=!1}},function(e){e.dropDown="dropDown",e.popOver="popOver"}(n=e.MenuListType||(e.MenuListType={})),e.initialize=function(){Yt(i(vt,"menus.registerNavBarMenuItemPressHandler"),"navBarMenuItemPress",c,!1),Yt(i(vt,"menus.registerActionMenuItemPressHandler"),"actionMenuItemPress",d,!1),Yt(i(vt,"menus.registerSetModuleViewHandler"),"setModuleView",s,!1)},e.setUpViews=function(e,t){if(Ze(Ue),!l())throw _e;o=t,vn(i(vt,"menus.setUpViews"),"setUpViews",[e])},e.setNavBarMenu=function(e,t){if(Ze(Ue),!l())throw _e;a=t,vn(i(vt,"menus.setNavBarMenu"),"setNavBarMenu",[e])},e.showActionMenu=function(e,t){if(Ze(Ue),!l())throw _e;r=t,vn(i(vt,"menus.showActionMenu"),"showActionMenu",[e])},e.isSupported=l}(yt||(yt={}));const St="v2",Dt=t("app");function It(e,t){return we()?(Dt.extend("initialize")("window object undefined at initialization"),Promise.resolve()):function(e,t,n){return new Promise((t,a)=>{const i=setTimeout(a,5e3,n);e().then(e=>{clearTimeout(i),t(e)}).catch(e=>{clearTimeout(i),a(e)})})}(()=>function(e,t){return new Promise(n=>{b.initializeCalled||(b.initializeCalled=!0,Wt.initializeHandlers(),b.initializePromise=function(e,t){if(fn.messageListener=e=>dn(this,void 0,void 0,function*(){return yield function(e){return dn(this,void 0,void 0,function*(){if(!e||!e.data||"object"!=typeof e.data)return void On("Unrecognized message format received by app, message being ignored. Message: %o",e);const t=e.source||e.originalEvent&&e.originalEvent.source,n=e.origin||e.originalEvent&&e.originalEvent.origin;return Ln(t,n).then(a=>{a?(function(e,t){b.isFramelessWindow||un.parentWindow&&!un.parentWindow.closed&&e!==un.parentWindow?un.childWindow&&!un.childWindow.closed&&e!==un.childWindow||(un.childWindow=e,un.childOrigin=t):(un.parentWindow=e,un.parentOrigin=t),un.parentWindow&&un.parentWindow.closed&&(un.parentWindow=null,un.parentOrigin=null),un.childWindow&&un.childWindow.closed&&(un.childWindow=null,un.childOrigin=null),Bn(un.parentWindow),Bn(un.childWindow)}(t,n),t===un.parentWindow?Tn(e):t===un.childWindow&&function(e){if("id"in e.data&&"func"in e.data){const t=(e=>{const{uuidAsString:t}=e,n=an(e,["uuidAsString"]);return Object.assign(Object.assign({},n),{uuid:t?new nn(t):void 0})})(e.data),[n,a]=Qt(t.func,t.args);n&&void 0!==a?Vn(t.id,t.uuid,Array.isArray(a)?a:[a]):vn(i("v2","tasks.startTask"),t.func,t.args,(...e)=>{if(un.childWindow){const n=e.pop();Vn(t.id,t.uuid,e,n)}})}}(e)):On("Message being ignored by app because it is either coming from the current window or a different window with an invalid origin")})})}(e)}),un.currentWindow=un.currentWindow||Oe(),un.parentWindow=un.currentWindow.parent!==un.currentWindow.self?un.currentWindow.parent:un.currentWindow.opener,un.topWindow=un.currentWindow.top,(un.parentWindow||e)&&un.currentWindow.addEventListener("message",fn.messageListener,!1),!un.parentWindow){const e=un.currentWindow;if(!e.nativeInterface)return Promise.reject(new Error("Initialization Failed. No Parent window found."));b.isFramelessWindow=!0,e.onNativeMessage=Tn}try{return un.parentOrigin="*",bn(t,"initialize",[qe,4,e]).then(([e,t,n,a])=>(function(e,t,n){var a;const i=sn;if(b.isFramelessWindow)return void i("Cannot polyfill nestedAppAuthBridge as current window is frameless");if(!t)return void i("Cannot polyfill nestedAppAuthBridge as current window does not exist");const r=(()=>{try{return JSON.parse(e)}catch(e){return null}})();if(!r||!(null===(a=r.supports)||void 0===a?void 0:a.nestedAppAuth))return void i("Cannot polyfill nestedAppAuthBridge as current hub does not support nested app auth");const o=t;if(o.nestedAppAuthBridge)return void i("nestedAppAuthBridge already exists on current window, skipping polyfill");const s=function(e,t){const n=cn;if(!e)return n("nestedAppAuthBridge cannot be created as current window does not exist"),null;const{onMessage:a,sendPostMessage:i}=t,r=e=>t=>a(t,e);return{addEventListener:(t,a)=>{"message"===t?e.addEventListener(t,r(a)):n(`Event ${t} is not supported by nestedAppAuthBridge`)},postMessage:e=>{const t=(()=>{try{return JSON.parse(e)}catch(e){return null}})();t&&"object"==typeof t&&"NestedAppAuthRequest"===t.messageType?i(e):n("Unrecognized data format received by app, message being ignored. Message: %o",e)},removeEventListener:(t,n)=>{e.removeEventListener(t,r(n))}}}(o,n);s&&(o.nestedAppAuthBridge=s)}(a,un.currentWindow,{onMessage:En,sendPostMessage:Sn}),{context:e,clientType:t,runtimeConfig:n,clientSupportedSDKVersion:a}))}finally{un.parentOrigin=null}}(t,e).then(({context:e,clientType:t,runtimeConfig:n,clientSupportedSDKVersion:a=s})=>{b.frameContext=e,b.hostClientType=t,b.clientSupportedSDKVersion=a;try{Et("Parsing %s",n);const e=JSON.parse(n);if(Et("Checking if %o is a valid runtime object",null!=e?e:"null"),!e||!e.apiVersion)throw new Error("Received runtime config is invalid");n&&We(e)}catch(e){if(!(e instanceof SyntaxError))throw e;try{Et("Attempting to parse %s as an SDK version",n),isNaN(ye(n,s))||(b.clientSupportedSDKVersion=n);const e=JSON.parse(a);if(Et("givenRuntimeConfig parsed to %o",null!=e?e:"null"),!e)throw new Error("givenRuntimeConfig string was successfully parsed. However, it parsed to value of null");We(e)}catch(e){if(!(e instanceof SyntaxError))throw e;We(Ge(b.clientSupportedSDKVersion,Fe,je))}}b.initializeCompleted=!0}),ft.initialize(),yt.initialize(),Gt.config.initialize(),gt.initialize()),Array.isArray(t)&&function(e){let t=b.additionalValidOrigins.concat(e.filter(e=>"string"==typeof e&&p.test(e)));const n={};t=t.filter(e=>!n[e]&&(n[e]=!0,!0)),b.additionalValidOrigins=t}(t),void 0!==b.initializePromise?n(b.initializePromise):Et("GlobalVars.initializePromise is unexpectedly undefined")})}(e,t),0,new Error("SDK initialization timed out."))}function xt(e){vn(e,kt.Messages.AppLoaded,[qe])}function Ct(e,t){vn(e,kt.Messages.ExpectedFailure,[t.reason,t.message])}function Ot(e,t){vn(e,kt.Messages.Failure,[t.reason,t.message])}function wt(e){vn(e,kt.Messages.Success,[qe])}const Et=Dt.extend("initializeHelper");function At(e,t){!tt(t)&&Xe(),function(e,t){Wt.themeChangeHandler=t,!tt(t)&&vn(e,"registerHandler",["themeChange"])}(e,t)}function Lt(e,t){return new Promise(n=>{Ze(Ue,de.content,de.sidePanel,de.settings,de.task,de.stage,de.meetingStage),n(mn(e,"executeDeepLink",t))})}var kt;!function(e){const n=t("app");let a,r,o;e.Messages={AppLoaded:"appInitialization.appLoaded",Success:"appInitialization.success",Failure:"appInitialization.failure",ExpectedFailure:"appInitialization.expectedFailure"},function(e){e.AuthFailed="AuthFailed",e.Timeout="Timeout",e.Other="Other"}(a=e.FailedReason||(e.FailedReason={})),function(e){e.PermissionError="PermissionError",e.NotFound="NotFound",e.Throttling="Throttling",e.Offline="Offline",e.Other="Other"}(r=e.ExpectedFailureReason||(e.ExpectedFailureReason={})),e.isInitialized=function(){return b.initializeCompleted},e.getFrameContext=function(){return b.frameContext},function(){if(we())return;const e=document.getElementsByTagName("script"),t=e&&e[e.length-1]&&e[e.length-1].src,a="Today, teamsjs can only be used from a single script or you may see undefined behavior. This log line is used to help detect cases where teamsjs is loaded multiple times -- it is always written. The presence of the log itself does not indicate a multi-load situation, but multiples of these log lines will. If you would like to use teamjs from more than one script at the same time, please open an issue at https://github.com/OfficeDev/microsoft-teams-library-js/issues";t&&0!==t.length?n("teamsjs is being used from %s. %s",t,a):n("teamsjs is being used from a script tag embedded directly in your html. %s",a)}(),e.initialize=function(e){return rt(),It(i(St,"app.initialize"),e)},e._initialize=function(e){un.currentWindow=e},e._uninitialize=function(){b.initializeCalled&&(Wt.uninitializeHandlers(),b.initializeCalled=!1,b.initializeCompleted=!1,b.initializePromise=void 0,b.additionalValidOrigins=[],b.frameContext=void 0,b.hostClientType=void 0,b.isFramelessWindow=!1,ct.telemetry._clearTelemetryPort(),ct.dataLayer._clearDataLayerPort(),un.currentWindow&&un.currentWindow.removeEventListener("message",fn.messageListener,!1),un.currentWindow=null,un.parentWindow=null,un.parentOrigin=null,un.childWindow=null,un.childOrigin=null,fn.parentMessageQueue=[],fn.childMessageQueue=[],fn.nextMessageId=0,fn.callbacks.clear(),fn.promiseCallbacks.clear(),fn.portCallbacks.clear(),fn.legacyMessageIdsToUuidMap={})},e.getContext=function(){return new Promise(e=>{Xe(),e(pn(i(St,"app.getContext"),"getContext"))}).then(e=>function(e){var t;return{actionInfo:e.actionInfo,app:{locale:e.locale,sessionId:e.appSessionId?e.appSessionId:"",theme:e.theme?e.theme:"default",iconPositionVertical:e.appIconPosition,osLocaleInfo:e.osLocaleInfo,parentMessageId:e.parentMessageId,userClickTime:e.userClickTime,userFileOpenPreference:e.userFileOpenPreference,host:{name:e.hostName?e.hostName:ce.teams,clientType:e.hostClientType?e.hostClientType:se.web,sessionId:e.sessionId?e.sessionId:"",ringId:e.ringId},appLaunchId:e.appLaunchId},page:{id:e.entityId,frameContext:e.frameContext?e.frameContext:b.frameContext,subPageId:e.subEntityId,isFullScreen:e.isFullScreen,isMultiWindow:e.isMultiWindow,isBackgroundLoad:e.isBackgroundLoad,sourceOrigin:e.sourceOrigin},user:{id:null!==(t=e.userObjectId)&&void 0!==t?t:"",displayName:e.userDisplayName,isCallingAllowed:e.isCallingAllowed,isPSTNCallingAllowed:e.isPSTNCallingAllowed,licenseType:e.userLicenseType,loginHint:e.loginHint,userPrincipalName:e.userPrincipalName,tenant:e.tid?{id:e.tid,teamsSku:e.tenantSKU}:void 0},channel:e.channelId?{id:e.channelId,displayName:e.channelName,relativeUrl:e.channelRelativeUrl,membershipType:e.channelType,defaultOneNoteSectionId:e.defaultOneNoteSectionId,ownerGroupId:e.hostTeamGroupId,ownerTenantId:e.hostTeamTenantId}:void 0,chat:e.chatId?{id:e.chatId}:void 0,meeting:e.meetingId?{id:e.meetingId}:void 0,sharepoint:e.sharepoint,team:e.teamId?{internalId:e.teamId,displayName:e.teamName,type:e.teamType,groupId:e.groupId,templateId:e.teamTemplateId,isArchived:e.isTeamArchived,userRole:e.userTeamRole}:void 0,sharePointSite:e.teamSiteUrl||e.teamSiteDomain||e.teamSitePath||e.mySitePath||e.mySiteDomain?{teamSiteUrl:e.teamSiteUrl,teamSiteDomain:e.teamSiteDomain,teamSitePath:e.teamSitePath,teamSiteId:e.teamSiteId,mySitePath:e.mySitePath,mySiteDomain:e.mySiteDomain}:void 0,dialogParameters:e.dialogParameters||{}}}(e))},e.notifyAppLoaded=function(){Xe(),xt(i(St,"app.notifyAppLoaded"))},e.notifySuccess=function(){Xe(),wt(i(St,"app.notifySuccess"))},e.notifyFailure=function(e){Xe(),Ot(i(St,"app.notifyFailure"),e)},e.notifyExpectedFailure=function(e){Xe(),Ct(i(St,"app.notifyExpectedFailure"),e)},e.registerOnThemeChangeHandler=function(e){At(i(St,"app.registerOnThemeChangeHandler"),e)},e.openLink=function(e){return Lt(i(St,"app.openLink"),e)},function(e){e.registerBeforeSuspendOrTerminateHandler=function(e){if(!e)throw new Error("[app.lifecycle.registerBeforeSuspendOrTerminateHandler] Handler cannot be null");Ze(Ue),function(e){Wt.beforeSuspendOrTerminateHandler=e,!tt(e)&&vn(i("v2","registerBeforeSuspendOrTerminateHandler"),"registerHandler",["beforeUnload"])}(e)},e.registerOnResumeHandler=function(e){if(!e)throw new Error("[app.lifecycle.registerOnResumeHandler] Handler cannot be null");Ze(Ue),function(e){Wt.resumeHandler=e,!tt(e)&&vn(i("v2","registerOnResumeHandler"),"registerHandler",["load"])}(e)}}(o=e.lifecycle||(e.lifecycle={}))}(kt||(kt={}));const Mt="v2";function Pt(e,t){return new Promise(n=>{if(Ze(Ue,de.content,de.sidePanel,de.settings,de.remove,de.task,de.stage,de.meetingStage),!Gt.isSupported())throw _e;n(_n(e,"navigateCrossDomain","Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.",t))})}function Tt(e){return new Promise(t=>{if(Ze(Ue),!Gt.backStack.isSupported())throw _e;t(_n(e,"navigateBack","Back navigation is not supported in the current client or context."))})}function Ut(e,t){return new Promise(n=>{if(Ze(Ue),!Gt.tabs.isSupported())throw _e;n(_n(e,"navigateToTab","Invalid internalTabInstanceId and/or channelId were/was provided",t))})}function Ft(e,t){if(Ze(Ue),!Gt.isSupported())throw _e;vn(e,"returnFocus",[t])}function Ht(e,t){return new Promise(n=>{if(Ze(Ue),!Gt.tabs.isSupported())throw _e;n(pn(e,"getTabInstances",t))})}function Rt(e,t){return new Promise(n=>{if(Ze(Ue),!Gt.tabs.isSupported())throw _e;n(pn(e,"getMruTabInstances",t))})}function Nt(e,t){if(Ze(Ue,de.content,de.sidePanel,de.meetingStage),!Gt.isSupported())throw _e;vn(e,"shareDeepLink",[t.subPageId,t.subPageLabel,t.subPageWebUrl])}function Bt(e,t){if(Ze(Ue,de.content),!Gt.isSupported())throw _e;vn(e,"setFrameContext",[t])}function jt(e,t){if(Ze(Ue,de.settings,de.remove),!Gt.config.isSupported())throw _e;vn(e,"settings.setValidityState",[t])}function Vt(e){return new Promise(t=>{if(Ze(Ue,de.content,de.settings,de.remove,de.sidePanel),!Gt.isSupported())throw _e;t(pn(e,"settings.getSettings"))})}function zt(e,t){return new Promise(n=>{if(Ze(Ue,de.content,de.settings,de.sidePanel),!Gt.config.isSupported())throw _e;n(mn(e,"settings.setSettings",t))})}var Gt;!function(e){function t(e){Bt(i(Mt,"pages.setCurrentFrame"),e)}function n(){return!(!Ze(Ue)||!Ue.supports.pages)}let a,r,o,s,c,d;e.returnFocus=function(e){Ft(i(Mt,"pages.returnFocus"),e)},e.registerFocusEnterHandler=function(e){Zt(i(Mt,"pages.registerFocusEnterHandler"),"focusEnter",e,[],()=>{if(!n())throw _e})},e.setCurrentFrame=t,e.initializeWithFrameContext=function(e,n,a){rt(),It(i(Mt,"pages.initializeWithFrameContext"),a).then(()=>n&&n()),t(e)},e.getConfig=function(){return Vt(i(Mt,"pages.getConfig."))},e.navigateCrossDomain=function(e){return Pt(i(Mt,"pages.navigateCrossDomain"),e)},e.navigateToApp=function(e){return new Promise(t=>{if(Ze(Ue,de.content,de.sidePanel,de.settings,de.task,de.stage,de.meetingStage),!n())throw _e;const a=i(Mt,"pages.navigateToApp");Ue.isLegacyTeams?t(mn(a,"executeDeepLink",function(e){const t=new URL("https://teams.microsoft.com/l/entity/"+encodeURIComponent(e.appId)+"/"+encodeURIComponent(e.pageId));return e.webUrl&&t.searchParams.append("webUrl",e.webUrl),(e.channelId||e.subPageId)&&t.searchParams.append("context",JSON.stringify({channelId:e.channelId,subEntityId:e.subPageId})),t.toString()}(e))):t(mn(a,"pages.navigateToApp",e))})},e.shareDeepLink=function(e){return Nt(i(Mt,"pages.shareDeepLink"),e)},e.registerFullScreenHandler=function(e){Zt(i(Mt,"pages.registerFullScreenHandler"),"fullScreenChange",e,[],()=>{if(!tt(e)&&!n())throw _e})},e.isSupported=n,function(e){e.navigateToTab=function(e){return Ut(i(Mt,"pages.tabs.navigateToTab"),e)},e.getTabInstances=function(e){return Ht(i(Mt,"pages.tabs.getTabInstances"),e)},e.getMruTabInstances=function(e){return Rt(i(Mt,"pages.tabs.getMruTabInstances"),e)},e.isSupported=function(){return!(!Ze(Ue)||!Ue.supports.pages||!Ue.supports.pages.tabs)}}(a=e.tabs||(e.tabs={})),function(e){let t,n;function a(e,n,a){!tt(n)&&Ze(Ue,de.settings),a&&a(),t=n,!tt(n)&&vn(e,"registerHandler",["save"])}function r(e,t,a){!tt(t)&&Ze(Ue,de.remove,de.settings),a&&a(),n=t,!tt(t)&&vn(e,"registerHandler",["remove"])}function o(e){const n=new s(e);t?t(n):un.childWindow?zn("settings.save",[e]):n.notifySuccess()}e.initialize=function(){Yt(i(Mt,"pages.config.registerSettingsSaveHandler"),"settings.save",o,!1),Yt(i(Mt,"pages.config.registerSettingsRemoveHandler"),"settings.remove",c,!1)},e.setValidityState=function(e){return jt(i(Mt,"pages.config.setValidityState"),e)},e.setConfig=function(e){return zt(i(Mt,"pages.config.setConfig"),e)},e.registerOnSaveHandler=function(e){a(i(Mt,"pages.config.registerOnSaveHandler"),e,()=>{if(!tt(e)&&!l())throw _e})},e.registerOnSaveHandlerHelper=a,e.registerOnRemoveHandler=function(e){r(i(Mt,"pages.config.registerOnRemoveHandler"),e,()=>{if(!tt(e)&&!l())throw _e})},e.registerOnRemoveHandlerHelper=r,e.registerChangeConfigHandler=function(e){Zt(i(Mt,"pages.config.registerChangeConfigHandler"),"changeSettings",e,[de.content],()=>{if(!l())throw _e})};class s{constructor(e){this.notified=!1,this.result=e||{}}notifySuccess(){this.ensureNotNotified(),vn(i(Mt,"pages.saveEvent.notifySuccess"),"settings.save.success"),this.notified=!0}notifyFailure(e){this.ensureNotNotified(),vn(i(Mt,"pages.saveEvent.notifyFailure"),"settings.save.failure",[e]),this.notified=!0}ensureNotNotified(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")}}function c(){const e=new d;n?n(e):un.childWindow?zn("settings.remove",[]):e.notifySuccess()}class d{constructor(){this.notified=!1}notifySuccess(){this.ensureNotNotified(),vn(i(Mt,"pages.removeEvent.notifySuccess"),"settings.remove.success"),this.notified=!0}notifyFailure(e){this.ensureNotNotified(),vn(i(Mt,"pages.removeEvent.notifyFailure"),"settings.remove.failure",[e]),this.notified=!0}ensureNotNotified(){if(this.notified)throw new Error("The removeEventType may only notify success or failure once.")}}function l(){return!(!Ze(Ue)||!Ue.supports.pages||!Ue.supports.pages.config)}e.isSupported=l}(r=e.config||(e.config={})),function(e){let t;function n(){return Tt(i(Mt,"pages.backStack.navigateBack"))}function a(e,n,a){!tt(n)&&Ze(Ue),a&&a(),t=n,!tt(n)&&vn(e,"registerHandler",["backButton"])}function r(){t&&t()||(un.childWindow?zn("backButtonPress",[]):n())}function o(){return!(!Ze(Ue)||!Ue.supports.pages||!Ue.supports.pages.backStack)}e._initialize=function(){Yt(i(Mt,"pages.backStack.registerBackButtonPressHandler"),"backButtonPress",r,!1)},e.navigateBack=n,e.registerBackButtonHandler=function(e){a(i(Mt,"pages.backStack.registerBackButtonHandler"),e,()=>{if(!tt(e)&&!o())throw _e})},e.registerBackButtonHandlerHelper=a,e.isSupported=o}(o=e.backStack||(e.backStack={})),function(e){function t(){return!(!Ze(Ue)||!Ue.supports.pages||!Ue.supports.pages.fullTrust)}e.enterFullscreen=function(){if(Ze(Ue,de.content),!t())throw _e;vn(i(Mt,"pages.fullTrust.enterFullscreen"),"enterFullscreen",[])},e.exitFullscreen=function(){if(Ze(Ue,de.content),!t())throw _e;vn(i(Mt,"pages.fullTrust.exitFullscreen"),"exitFullscreen",[])},e.isSupported=t}(s=e.fullTrust||(e.fullTrust={})),function(e){function t(){return!(!Ze(Ue)||!Ue.supports.pages||!Ue.supports.pages.appButton)}e.onClick=function(e){Zt(i(Mt,"pages.appButton.onClick"),"appButtonClick",e,[de.content],()=>{if(!t())throw _e})},e.onHoverEnter=function(e){Zt(i(Mt,"pages.appButton.onHoverEnter"),"appButtonHoverEnter",e,[de.content],()=>{if(!t())throw _e})},e.onHoverLeave=function(e){Zt(i(Mt,"pages.appButton.onHoverLeave"),"appButtonHoverLeave",e,[de.content],()=>{if(!t())throw _e})},e.isSupported=t}(c=e.appButton||(e.appButton={})),function(e){function t(){return!(!Ze(Ue)||!Ue.supports.pages||!Ue.supports.pages.currentApp)}e.navigateTo=function(e){return new Promise(n=>{if(Ze(Ue,de.content,de.sidePanel,de.settings,de.task,de.stage,de.meetingStage),!t())throw _e;n(hn(i(Mt,"pages.currentApp.navigateTo"),"pages.currentApp.navigateTo",e))})},e.navigateToDefaultPage=function(){return new Promise(e=>{if(Ze(Ue,de.content,de.sidePanel,de.settings,de.task,de.stage,de.meetingStage),!t())throw _e;e(hn(i(Mt,"pages.currentApp.navigateToDefaultPage"),"pages.currentApp.navigateToDefaultPage"))})},e.isSupported=t}(d=e.currentApp||(e.currentApp={}))}(Gt||(Gt={}));const Kt=t("handlers");class Wt{static initializeHandlers(){Wt.handlers.themeChange=$t,Wt.handlers.load=en,Wt.handlers.beforeUnload=tn,Gt.backStack._initialize()}static uninitializeHandlers(){Wt.handlers={},Wt.themeChangeHandler=null,Wt.loadHandler=null,Wt.beforeUnloadHandler=null,Wt.beforeSuspendOrTerminateHandler=null,Wt.resumeHandler=null}}Wt.handlers={},Wt.themeChangeHandler=null,Wt.loadHandler=null,Wt.beforeUnloadHandler=null,Wt.beforeSuspendOrTerminateHandler=null,Wt.resumeHandler=null;const qt=Kt.extend("callHandler");function Qt(e,t){const n=Wt.handlers[e];return n?(qt("Invoking the registered handler for message %s with arguments %o",e,t),[!0,n.apply(this,t)]):un.childWindow?(zn(e,t),[!1,void 0]):(qt("Handler for action message %s not found.",e),[!1,void 0])}function Yt(e,t,n,a=!0,i=[]){n?(Wt.handlers[t]=n,a&&vn(e,"registerHandler",[t,...i])):delete Wt.handlers[t]}function Jt(e){delete Wt.handlers[e]}function Xt(e){return null!=Wt.handlers[e]}function Zt(e,t,n,a,i){n&&Ze(Ue,...a),i&&i(),Yt(e,t,n)}function $t(e){Wt.themeChangeHandler&&Wt.themeChangeHandler(e),un.childWindow&&zn("themeChange",[e])}function en(e){const t=function(e){return{entityId:e.entityId,contentUrl:new URL(e.contentUrl)}}(e);Wt.resumeHandler?(Wt.resumeHandler(t),un.childWindow&&zn("load",[t])):Wt.loadHandler&&(Wt.loadHandler(e),un.childWindow&&zn("load",[e]))}function tn(){return function(e,t,n,a){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(t,n){function r(e){try{s(a.next(e))}catch(e){n(e)}}function o(e){try{s(a.throw(e))}catch(e){n(e)}}function s(e){e.done?t(e.value):i(e.value).then(r,o)}s((a=a.apply(e,[])).next())})}(this,0,void 0,function*(){const e=()=>{vn(i("v2","handleBeforeUnload"),"readyToUnload",[])};Wt.beforeSuspendOrTerminateHandler?(yield Wt.beforeSuspendOrTerminateHandler(),un.childWindow?zn("beforeUnload"):e()):Wt.beforeUnloadHandler&&Wt.beforeUnloadHandler(e)||(un.childWindow?zn("beforeUnload"):e())})}class nn{constructor(e=Se()){this.uuid=e,Me(e)}toString(){return this.uuid}}var an=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n};const rn=e=>{const{uuid:t}=e,n=an(e,["uuid"]),a=null==t?void 0:t.toString();return Object.assign(Object.assign({},n),{uuidAsString:a})},on=t("nestedAppAuthUtils"),sn=on.extend("tryPolyfillWithNestedAppAuthBridge"),cn=on.extend("createNestedAppAuthBridge");var dn=function(e,t,n,a){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((a=a.apply(e,t||[])).next())})};const ln=t("communication");class un{}class fn{}function pn(e,t,...n){return bn(e,t,n).then(([e])=>e)}function mn(e,t,...n){return bn(e,t,n).then(([e,t])=>{if(!e)throw new Error(t)})}function _n(e,t,n,...a){return bn(e,t,a).then(([e,t])=>{if(!e)throw new Error(t||n)})}function hn(e,t,...n){return bn(e,t,n).then(([e,t])=>{if(e)throw e;return t})}function bn(e,t,n){if(!r(e))throw Error(`apiVersionTag: ${e} passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.`);return new Promise(a=>{a(function(e){return new Promise(t=>{fn.promiseCallbacks.set(e,t)})}(Cn(e,t,n).uuid))})}function gn(e,t,n){if(!r(e))throw Error(`apiVersionTag: ${e} passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.`);return function(e){return new Promise((t,n)=>{fn.portCallbacks.set(e,(e,a)=>{e instanceof MessagePort?t(e):n(a&&a.length>0?a[0]:new Error("Host responded without port or error details."))})})}(Cn(e,t,n).uuid)}function vn(e,t,n,a){let i;if(n instanceof Function?a=n:n instanceof Array&&(i=n),!r(e))throw Error(`apiVersionTag: ${e} passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.`);const o=Cn(e,t,i);a&&fn.callbacks.set(o.uuid,a)}fn.parentMessageQueue=[],fn.childMessageQueue=[],fn.topMessageQueue=[],fn.nextMessageId=0,fn.callbacks=new Map,fn.promiseCallbacks=new Map,fn.portCallbacks=new Map,fn.legacyMessageIdsToUuidMap={};const yn=ln.extend("sendNestedAuthRequestToTopWindow");function Sn(e){const t=yn,n=un.topWindow,a=function(e){const t=fn.nextMessageId++,n=new nn;return fn.legacyMessageIdsToUuidMap[t]=n,{id:t,uuid:n,func:"nestedAppAuth.execute",timestamp:Date.now(),args:[],data:e}}(e);return t("Message %i information: %o",a.uuid,{actionName:a.func}),In(n,a)}const Dn=ln.extend("sendRequestToTargetWindowHelper");function In(e,t){const n=Dn,a=Rn(e),i=rn(t);if(b.isFramelessWindow)un.currentWindow&&un.currentWindow.nativeInterface&&(n(`Sending message %i to ${a} via framelessPostMessage interface`,i.uuidAsString),un.currentWindow.nativeInterface.framelessPostMessage(JSON.stringify(i)));else{const r=Hn(e);e&&r?(n(`Sending message %i to ${a} via postMessage`,i.uuidAsString),e.postMessage(i,r)):(n(`Adding message %i to ${a} message queue`,i.uuidAsString),Fn(e).push(t))}return t}const xn=ln.extend("sendMessageToParentHelper");function Cn(e,t,n){const a=xn,i=un.parentWindow,r=function(e,t,n){const a=fn.nextMessageId++,i=new nn;return fn.legacyMessageIdsToUuidMap[a]=i,{id:a,uuid:i,func:t,timestamp:Date.now(),args:n||[],apiVersionTag:e}}(e,t,n);return a("Message %i information: %o",r.uuid,{actionName:t,args:n}),In(i,r)}const On=ln.extend("processMessage"),wn=ln.extend("processAuthBridgeMessage");function En(e,t){var n,a;const i=wn;if(!e||!e.data||"object"!=typeof e.data)return void i("Unrecognized message format received by app, message being ignored. Message: %o",e);const{args:r}=e.data,[,o]=null!=r?r:[],s=(()=>{try{return JSON.parse(o)}catch(e){return null}})();if(!s||"object"!=typeof s||"NestedAppAuthResponse"!==s.messageType)return void i("Unrecognized data format received by app, message being ignored. Message: %o",e);const c=e.source||(null===(n=null==e?void 0:e.originalEvent)||void 0===n?void 0:n.source),d=e.origin||(null===(a=null==e?void 0:e.originalEvent)||void 0===a?void 0:a.origin);c?Ln(c,d)?(un.topWindow&&!un.topWindow.closed&&c!==un.topWindow||(un.topWindow=c,un.topOrigin=d),un.topWindow&&un.topWindow.closed&&(un.topWindow=null,un.topOrigin=null),Bn(un.topWindow),t(o)):i("Message being ignored by app because it is either coming from the current window or a different window with an invalid origin"):i("Message being ignored by app because it is coming for a target that is null")}const An=ln.extend("shouldProcessMessage");function Ln(e,t){return dn(this,void 0,void 0,function*(){if(un.currentWindow&&e===un.currentWindow)return An("Should not process message because it is coming from the current window"),!1;if(un.currentWindow&&un.currentWindow.location&&t&&t===un.currentWindow.location.origin)return!0;{const e=yield function(e){return ot().then(t=>{if(!Ce(e))return it("Origin %s is invalid because it is not using https protocol. Protocol being used: %s",e,e.protocol),!1;const n=e.host;if(t.some(e=>st(e,n)))return!0;for(const e of b.additionalValidOrigins)if(st("https://"===e.substring(0,8)?e.substring(8):e,n))return!0;return it("Origin %s is invalid because it is not an origin approved by this library or included in the call to app.initialize.\nOrigins approved by this library: %o\nOrigins included in app.initialize: %o",e,t,b.additionalValidOrigins),!1})}(new URL(t));return e||An("Message has an invalid origin of %s",t),e}})}const kn=ln.extend("handleParentMessage");function Mn(e,t){if(t){const n=[...e].find(([e,n])=>e.toString()===t.toString());if(n)return n[0]}}function Pn(e,t){const n=Mn(t,e.uuid);n&&t.delete(n),e.uuid?fn.legacyMessageIdsToUuidMap={}:delete fn.legacyMessageIdsToUuidMap[e.id]}function Tn(e){const t=kn;if("id"in e.data&&"number"==typeof e.data.id){const n=(e=>{const{uuidAsString:t}=e,n=an(e,["uuidAsString"]);return Object.assign(Object.assign({},n),{uuid:t?new nn(t):void 0})})(e.data),a=function(e){var t;const n=kn;if(!e.uuid)return fn.legacyMessageIdsToUuidMap[e.id];{const t=e.uuid,n=Mn(fn.callbacks,t);if(n)return n;const a=Mn(fn.promiseCallbacks,t);if(a)return a;const i=Mn(fn.portCallbacks,t);if(i)return i}n(`Received a message with uuid: ${null===(t=e.uuid)||void 0===t?void 0:t.toString()} and legacyId: %i that failed to produce a callbackId`,e.id)}(n);if(a){const i=fn.callbacks.get(a);t("Received a response from parent for message %i",a),i&&(t("Invoking the registered callback for message %i with arguments %o",a,n.args),i.apply(null,[...n.args,n.isPartialResponse]),function(e){return!0===e.data.isPartialResponse}(e)||(t("Removing registered callback for message %i",a),Pn(n,fn.callbacks)));const r=fn.promiseCallbacks.get(a);r&&(t("Invoking the registered promise callback for message %i with arguments %o",a,n.args),r(n.args),t("Removing registered promise callback for message %i",a),Pn(n,fn.promiseCallbacks));const o=fn.portCallbacks.get(a);if(o){let i;t("Invoking the registered port callback for message %i with arguments %o",a,n.args),e.ports&&e.ports[0]instanceof MessagePort&&(i=e.ports[0]),o(i,n.args),t("Removing registered port callback for message %i",a),Pn(n,fn.portCallbacks)}n.uuid&&(fn.legacyMessageIdsToUuidMap={})}}else if("func"in e.data&&"string"==typeof e.data.func){const n=e.data;t("Received an action message %s from parent",n.func),Qt(n.func,n.args)}else t("Received an unknown message: %O",e)}function Un(){return un.topWindow!==un.parentWindow}function Fn(e){return e===un.topWindow&&Un()?fn.topMessageQueue:e===un.parentWindow?fn.parentMessageQueue:e===un.childWindow?fn.childMessageQueue:[]}function Hn(e){return e===un.topWindow&&Un()?un.topOrigin:e===un.parentWindow?un.parentOrigin:e===un.childWindow?un.childOrigin:null}function Rn(e){return e===un.topWindow&&Un()?"top":e===un.parentWindow?"parent":e===un.childWindow?"child":null}const Nn=ln.extend("flushMessageQueue");function Bn(e){const t=Hn(e),n=Fn(e),a=Rn(e);for(;e&&t&&n.length>0;){const i=n.shift();if(i){const n=rn(i);Nn("Flushing message %i from "+a+" message queue via postMessage.",null==n?void 0:n.uuidAsString),e.postMessage(n,t)}}}function jn(e,t){let n;n=un.currentWindow.setInterval(()=>{0===Fn(e).length&&(clearInterval(n),t())},100)}function Vn(e,t,n,a){const i=un.childWindow,r=function(e,t,n,a){return{id:e,uuid:t,args:n||[],isPartialResponse:a}}(e,t,n,a),o=(e=>{const{uuid:t}=e,n=an(e,["uuid"]),a=null==t?void 0:t.toString();return Object.assign(Object.assign({},n),{uuidAsString:a})})(r),s=Hn(i);i&&s&&i.postMessage(o,s)}function zn(e,t){const n=un.childWindow,a=function(e,t){return{func:e,args:t||[]}}(e,t),i=Hn(n);n&&i?n.postMessage(a,i):Fn(n).push(a)}var Gn,Kn,Wn,qn;!function(e){function t(){return!(!Ze(Ue)||!Ue.supports.logs)}e.registerGetLogHandler=function(e){if(!tt(e)&&Ze(Ue),!tt(e)&&!t())throw _e;e?Yt(i("v1","log.request"),"log.request",()=>{const t=e();vn(i("v1","log.receive"),"log.receive",[t])}):Jt("log.request")},e.isSupported=t}(Gn||(Gn={})),function(e){e.fileDownloadStart="fileDownloadStart",e.fileDownloadComplete="fileDownloadComplete"}(Kn||(Kn={})),function(e){e.view="view",e.edit="edit",e.editNew="editNew"}(Wn||(Wn={})),function(e){e.fileOpenPreference="fileOpenPreference",e.theme="theme"}(qn||(qn={}));const Qn="v1";function Yn(e,t){Ze(Ue),vn(i(Qn,"uploadCustomApp"),"uploadCustomApp",[e],t||ve())}function Jn(e,t,n){Ze(Ue),vn(i(Qn,"sendCustomMessage"),e,t,n)}function Xn(e,t){if(Ze(Ue),!un.childWindow)throw new Error("The child window has not yet been initialized or is not present");zn(e,t)}function Zn(e,t){Ze(Ue),Yt(i(Qn,"registerCustomHandler"),e,(...e)=>t.apply(this,e))}function $n(e,t){Ze(Ue),Yt(i(Qn,"registerUserSettingsChangeHandler"),"userSettingsChange",t,!0,[e])}function ea(e){Ze(Ue,de.content,de.task);const t=[e.entityId,e.title,e.description,e.type,e.objectUrl,e.downloadUrl,e.webPreviewUrl,e.webEditUrl,e.baseUrl,e.editFile,e.subEntityId,e.viewerAction,e.fileOpenPreference,e.conversationId,e.sizeInBytes];vn(i(Qn,"openFilePreview"),"openFilePreview",t)}const ta="v1";var na;!function(e){function t(){return!(!Ze(Ue)||!Ue.supports.conversations)}e.openConversation=function(e){return new Promise(n=>{if(Ze(Ue,de.content),!t())throw _e;const a=mn(i(ta,"conversations.openConversation"),"conversations.openConversation",{title:e.title,subEntityId:e.subEntityId,conversationId:e.conversationId,channelId:e.channelId,entityId:e.entityId});e.onStartConversation&&Yt(i(ta,"conversations.registerStartConversationHandler"),"startConversation",(t,n,a,i)=>{var r;return null===(r=e.onStartConversation)||void 0===r?void 0:r.call(e,{subEntityId:t,conversationId:n,channelId:a,entityId:i})}),e.onCloseConversation&&Yt(i(ta,"conversations.registerCloseConversationHandler"),"closeConversation",(t,n,a,i)=>{var r;return null===(r=e.onCloseConversation)||void 0===r?void 0:r.call(e,{subEntityId:t,conversationId:n,channelId:a,entityId:i})}),n(a)})},e.closeConversation=function(){if(Ze(Ue,de.content),!t())throw _e;vn(i(ta,"conversations.closeConversation"),"conversations.closeConversation"),Jt("startConversation"),Jt("closeConversation")},e.getChatMembers=function(){return new Promise(e=>{if(Ze(Ue),!t())throw _e;e(pn(i(ta,"conversations.getChatMember"),"getChatMembers"))})},e.isSupported=t}(na||(na={}));const aa="v2";var ia,ra,oa;!function(e){const t="Action.Execute";let n,a,r;function o(e){if(e.requestType===n.ActionExecuteInvokeRequest){const n=e;if(n.type!==t)throw{errorCode:r.INTERNAL_ERROR,message:`Invalid action type ${n.type}. Action type must be "${t}"`}}else if(e.requestType===n.QueryMessageExtensionRequest){if(e.commandId.length>64)throw new Error("originalRequestInfo.commandId exceeds the maximum size of 64 characters");if(e.parameters.length>5)throw new Error("originalRequestInfo.parameters exceeds the maximum size of 5");for(const t of e.parameters){if(t.name.length>64)throw new Error("originalRequestInfo.parameters.name exceeds the maximum size of 64 characters");if(t.value.length>512)throw new Error("originalRequestInfo.parameters.value exceeds the maximum size of 512 characters")}}}function s(){return!(!Ze(Ue)||!Ue.supports.externalAppAuthentication)}!function(e){e.ActionExecuteInvokeRequest="ActionExecuteInvokeRequest",e.QueryMessageExtensionRequest="QueryMessageExtensionRequest"}(n=e.OriginalRequestType||(e.OriginalRequestType={})),function(e){e.ActionExecuteInvokeResponse="ActionExecuteInvokeResponse",e.QueryMessageExtensionResponse="QueryMessageExtensionResponse"}(a=e.InvokeResponseType||(e.InvokeResponseType={})),function(e){e.INTERNAL_ERROR="INTERNAL_ERROR"}(r=e.InvokeErrorCode||(e.InvokeErrorCode={})),e.authenticateAndResendRequest=function(e,t,n){if(Ze(Ue,de.content),!s())throw _e;return Ee(e,new Error("App id is not valid.")),o(n),bn(i(aa,"externalAppAuthentication.authenticateAndResendRequest"),"externalAppAuthentication.authenticateAndResendRequest",[e,n,t.url.href,t.width,t.height,t.isExternal]).then(([e,t])=>{if(e&&null!=t.responseType)return t;throw t})},e.authenticateWithSSO=function(e,t){if(Ze(Ue,de.content),!s())throw _e;return Ee(e,new Error("App id is not valid.")),bn(i(aa,"externalAppAuthentication.authenticateWithSSO"),"externalAppAuthentication.authenticateWithSSO",[e,t.claims,t.silent]).then(([e,t])=>{if(!e)throw t})},e.authenticateWithSSOAndResendRequest=function(e,t,n){if(Ze(Ue,de.content),!s())throw _e;return Ee(e,new Error("App id is not valid.")),o(n),bn(i(aa,"externalAppAuthentication.authenticateWithSSOAndResendRequest"),"externalAppAuthentication.authenticateWithSSOAndResendRequest",[e,n,t.claims,t.silent]).then(([e,t])=>{if(e&&null!=t.responseType)return t;throw t})},e.authenticateWithOauth2=function(e,t,n){if(Ze(Ue,de.content),!s())throw _e;return Ee(e,new Error("titleId is Invalid.")),Ee(t,new Error("oauthConfigId is Invalid.")),bn(i(aa,"externalAppAuthentication.authenticateWithOauth2"),"externalAppAuthentication.authenticateWithOauth2",[e,t,n.width,n.height,n.isExternal]).then(([e,t])=>{if(!e)throw t})},e.authenticateWithPowerPlatformConnectorPlugins=function(e,t,n){if(Ze(Ue,de.content),!s())throw _e;return Ee(e,new Error("titleId is Invalid.")),t&&Ae(t),bn(i(aa,"externalAppAuthentication.authenticateWithPowerPlatformConnectorPlugins"),"externalAppAuthentication.authenticateWithPowerPlatformConnectorPlugins",[e,null==t?void 0:t.toString(),null==n?void 0:n.width,null==n?void 0:n.height,null==n?void 0:n.isExternal]).then(([e,t])=>{if(!e)throw t})},e.isSupported=s}(ia||(ia={})),function(e){let t,n;function a(){return!(!Ze(Ue)||!Ue.supports.externalAppCardActions)}!function(e){e.DeepLinkDialog="DeepLinkDialog",e.DeepLinkOther="DeepLinkOther",e.DeepLinkStageView="DeepLinkStageView",e.GenericUrl="GenericUrl"}(t=e.ActionOpenUrlType||(e.ActionOpenUrlType={})),function(e){e.INTERNAL_ERROR="INTERNAL_ERROR",e.INVALID_LINK="INVALID_LINK",e.NOT_SUPPORTED="NOT_SUPPORTED"}(n=e.ActionOpenUrlErrorCode||(e.ActionOpenUrlErrorCode={})),e.processActionSubmit=function(e,t){if(Ze(Ue,de.content),!a())throw _e;return Ee(e,new Error("App id is not valid.")),bn(i("v2","externalAppCardActions.processActionSubmit"),"externalAppCardActions.processActionSubmit",[e,t]).then(([e,t])=>{if(!e)throw t})},e.processActionOpenUrl=function(e,t,n){if(Ze(Ue,de.content),!a())throw _e;return Ee(e,new Error("App id is not valid.")),bn(i("v2","externalAppCardActions.processActionOpenUrl"),"externalAppCardActions.processActionOpenUrl",[e,t.href,n]).then(([e,t])=>{if(e)throw e;return t})},e.isSupported=a}(ra||(ra={})),function(e){function t(){return!(!Ze(Ue)||!Ue.supports.externalAppCommands)}e.processActionCommand=function(e,n,a){return function(e,t,n,a){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(t,n){function r(e){try{s(a.next(e))}catch(e){n(e)}}function o(e){try{s(a.throw(e))}catch(e){n(e)}}function s(e){e.done?t(e.value):i(e.value).then(r,o)}s((a=a.apply(e,[])).next())})}(this,0,void 0,function*(){if(Ze(Ue,de.content),!t())throw _e;Ee(e,new Error("App id is not valid."));const[r,o]=yield bn(i("v2","externalAppCommands.processActionCommand"),"externalAppCommands.processActionCommand",[e,n,a]);if(r)throw r;return o})},e.isSupported=t}(oa||(oa={}));const sa="v1";var ca;!function(e){let t,n,a,r,o,s;function c(e,t){return{errorCode:e,message:t}}!function(e){e.Dropbox="DROPBOX",e.Box="BOX",e.Sharefile="SHAREFILE",e.GoogleDrive="GOOGLEDRIVE",e.Egnyte="EGNYTE",e.SharePoint="SharePoint"}(t=e.CloudStorageProvider||(e.CloudStorageProvider={})),function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WopiIntegration=1]="WopiIntegration",e[e.Google=2]="Google",e[e.OneDrive=3]="OneDrive",e[e.Recent=4]="Recent",e[e.Aggregate=5]="Aggregate",e[e.FileSystem=6]="FileSystem",e[e.Search=7]="Search",e[e.AllFiles=8]="AllFiles",e[e.SharedWithMe=9]="SharedWithMe"}(n=e.CloudStorageProviderType||(e.CloudStorageProviderType={})),function(e){e.ClassMaterials="classMaterials"}(a=e.SpecialDocumentLibraryType||(e.SpecialDocumentLibraryType={})),function(e){e.Readonly="readonly"}(r=e.DocumentLibraryAccessType||(e.DocumentLibraryAccessType={})),function(e){e.Downloaded="Downloaded",e.Downloading="Downloading",e.Failed="Failed"}(o=e.FileDownloadStatus||(e.FileDownloadStatus={})),function(e){e.Download="DOWNLOAD",e.Upload="UPLOAD",e.Delete="DELETE"}(s=e.CloudStorageProviderFileAction||(e.CloudStorageProviderFileAction={})),e.getCloudStorageFolders=function(e,t){if(Ze(Ue,de.content),!e||0===e.length)throw new Error("[files.getCloudStorageFolders] channelId name cannot be null or empty");if(!t)throw new Error("[files.getCloudStorageFolders] Callback cannot be null");vn(i(sa,"files.getCloudStorageFolders"),"files.getCloudStorageFolders",[e],t)},e.addCloudStorageFolder=function(e,t){if(Ze(Ue,de.content),!e||0===e.length)throw new Error("[files.addCloudStorageFolder] channelId name cannot be null or empty");if(!t)throw new Error("[files.addCloudStorageFolder] Callback cannot be null");vn(i(sa,"files.addCloudStorageFolder"),"files.addCloudStorageFolder",[e],t)},e.deleteCloudStorageFolder=function(e,t,n){if(Ze(Ue,de.content),!e)throw new Error("[files.deleteCloudStorageFolder] channelId name cannot be null or empty");if(!t)throw new Error("[files.deleteCloudStorageFolder] folderToDelete cannot be null or empty");if(!n)throw new Error("[files.deleteCloudStorageFolder] Callback cannot be null");vn(i(sa,"files.deleteCloudStorageFolder"),"files.deleteCloudStorageFolder",[e,t],n)},e.getCloudStorageFolderContents=function(e,t,n){if(Ze(Ue,de.content),!e||!t)throw new Error("[files.getCloudStorageFolderContents] folder/providerCode name cannot be null or empty");if(!n)throw new Error("[files.getCloudStorageFolderContents] Callback cannot be null");if("isSubdirectory"in e&&!e.isSubdirectory)throw new Error("[files.getCloudStorageFolderContents] provided folder is not a subDirectory");vn(i(sa,"files.getCloudStorageFolderContents"),"files.getCloudStorageFolderContents",[e,t],n)},e.openCloudStorageFile=function(e,t,n){if(Ze(Ue,de.content),!e||!t)throw new Error("[files.openCloudStorageFile] file/providerCode cannot be null or empty");if(e.isSubdirectory)throw new Error("[files.openCloudStorageFile] provided file is a subDirectory");vn(i(sa,"files.openCloudStorageFile"),"files.openCloudStorageFile",[e,t,n])},e.getExternalProviders=function(e=!1,t){if(Ze(Ue,de.content),!t)throw new Error("[files.getExternalProviders] Callback cannot be null");vn(i(sa,"files.getExternalProviders"),"files.getExternalProviders",[e],t)},e.copyMoveFiles=function(e,t,n,a,r=!1,o){if(Ze(Ue,de.content),!e||0===e.length)throw new Error("[files.copyMoveFiles] selectedFiles cannot be null or empty");if(!t)throw new Error("[files.copyMoveFiles] providerCode cannot be null or empty");if(!n)throw new Error("[files.copyMoveFiles] destinationFolder cannot be null or empty");if(!a)throw new Error("[files.copyMoveFiles] destinationProviderCode cannot be null or empty");if(!o)throw new Error("[files.copyMoveFiles] callback cannot be null");vn(i(sa,"files.copyMoveFiles"),"files.copyMoveFiles",[e,t,n,a,r],o)},e.getFileDownloads=function(e){if(Ze(Ue,de.content),!e)throw new Error("[files.getFileDownloads] Callback cannot be null");vn(i(sa,"files.getFileDownloads"),"files.getFileDownloads",[],e)},e.openDownloadFolder=function(e,t){if(Ze(Ue,de.content),!t)throw new Error("[files.openDownloadFolder] Callback cannot be null");vn(i(sa,"files.openDownloadFolder"),"files.openDownloadFolder",[e],t)},e.addCloudStorageProvider=function(e){if(Ze(Ue,de.content),!e)throw c(ie.INVALID_ARGUMENTS,"[files.addCloudStorageProvider] callback cannot be null");vn(i(sa,"files.addCloudStorageProvider"),"files.addCloudStorageProvider",[],e)},e.removeCloudStorageProvider=function(e,t){if(Ze(Ue,de.content),!t)throw c(ie.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] callback cannot be null");if(!e||!e.content)throw c(ie.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] 3P cloud storage provider request content is missing");vn(i(sa,"files.removeCloudStorageProvider"),"files.removeCloudStorageProvider",[e],t)},e.addCloudStorageProviderFile=function(e,t){if(Ze(Ue,de.content),!t)throw c(ie.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] callback cannot be null");if(!e||!e.content)throw c(ie.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] 3P cloud storage provider request content is missing");vn(i(sa,"files.addCloudStorageProviderFile"),"files.addCloudStorageProviderFile",[e],t)},e.renameCloudStorageProviderFile=function(e,t){if(Ze(Ue,de.content),!t)throw c(ie.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] callback cannot be null");if(!e||!e.content)throw c(ie.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] 3P cloud storage provider request content is missing");vn(i(sa,"files.renameCloudStorageProviderFile"),"files.renameCloudStorageProviderFile",[e],t)},e.deleteCloudStorageProviderFile=function(e,t){if(Ze(Ue,de.content),!t)throw c(ie.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw c(ie.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] 3P cloud storage provider request content details are missing");vn(i(sa,"files.deleteCloudStorageProviderFile"),"files.deleteCloudStorageProviderFile",[e],t)},e.downloadCloudStorageProviderFile=function(e,t){if(Ze(Ue,de.content),!t)throw c(ie.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw c(ie.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");vn(i(sa,"files.downloadCloudStorageProviderFile"),"files.downloadCloudStorageProviderFile",[e],t)},e.uploadCloudStorageProviderFile=function(e,t){if(Ze(Ue,de.content),!t)throw c(ie.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw c(ie.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");if(!e.content.destinationFolder)throw c(ie.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] Invalid destination folder details");vn(i(sa,"files.uploadCloudStorageProviderFile"),"files.uploadCloudStorageProviderFile",[e],t)},e.registerCloudStorageProviderListChangeHandler=function(e){if(Ze(Ue),!e)throw new Error("[registerCloudStorageProviderListChangeHandler] Handler cannot be null");Yt(i(sa,"files.registerCloudStorageProviderListChangeHandler"),"files.cloudStorageProviderListChange",e)},e.registerCloudStorageProviderContentChangeHandler=function(e){if(Ze(Ue),!e)throw new Error("[registerCloudStorageProviderContentChangeHandler] Handler cannot be null");Yt(i(sa,"files.registerCloudStorageProviderContentChangeHandler"),"files.cloudStorageProviderContentChange",e)}}(ca||(ca={}));const da="v1";var la,ua,fa;!function(e){function t(){return!(!Ze(Ue)||!Ue.supports.meetingRoom)}e.getPairedMeetingRoomInfo=function(){return new Promise(e=>{if(Ze(Ue),!t())throw _e;e(hn(i(da,"meetingRoom.getPairedMeetingRoomInfo"),"meetingRoom.getPairedMeetingRoomInfo"))})},e.sendCommandToPairedMeetingRoom=function(e){return new Promise(n=>{if(!e||0==e.length)throw new Error("[meetingRoom.sendCommandToPairedMeetingRoom] Command name cannot be null or empty");if(Ze(Ue),!t())throw _e;n(hn(i(da,"meetingRoom.sendCommandToPairedMeetingRoom"),"meetingRoom.sendCommandToPairedMeetingRoom",e))})},e.registerMeetingRoomCapabilitiesUpdateHandler=function(e){if(!e)throw new Error("[meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler] Handler cannot be null");if(Ze(Ue),!t())throw _e;Yt(i(da,"meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler"),"meetingRoom.meetingRoomCapabilitiesUpdate",t=>{Ze(Ue),e(t)})},e.registerMeetingRoomStatesUpdateHandler=function(e){if(!e)throw new Error("[meetingRoom.registerMeetingRoomStatesUpdateHandler] Handler cannot be null");if(Ze(Ue),!t())throw _e;Yt(i(da,"meetingRoom.registerMeetingRoomStatesUpdateHandler"),"meetingRoom.meetingRoomStatesUpdate",t=>{Ze(Ue),e(t)})},e.isSupported=t}(la||(la={})),function(e){function t(){return!(!Ze(Ue)||!Ue.supports.notifications)}e.showNotification=function(e){if(Ze(Ue,de.content),!t())throw _e;vn(i("v1","notifications.showNotification"),"notifications.showNotification",[e])},e.isSupported=t}(ua||(ua={})),function(e){function t(){return!(!Ze(Ue)||!Ue.supports.otherAppStateChange)}e.registerAppInstallationHandler=function(e){if(!t())throw new Error(ie.NOT_SUPPORTED_ON_PLATFORM.toString());if(tt(e))throw new Error(ie.INVALID_ARGUMENTS.toString());Yt(i("v2","otherApp.install"),"otherApp.install",e)},e.unregisterAppInstallationHandler=function(){if(!t())throw new Error(ie.NOT_SUPPORTED_ON_PLATFORM.toString());vn(i("v2","otherApp.unregisterInstall"),"otherApp.unregisterInstall"),Jt("otherApp.install")},e.isSupported=t}(fa||(fa={}));const pa="v1";var ma,_a;!function(e){let t,n,a;function r(){return!(!Ze(Ue)||!Ue.supports.remoteCamera)}!function(e){e.Reset="Reset",e.ZoomIn="ZoomIn",e.ZoomOut="ZoomOut",e.PanLeft="PanLeft",e.PanRight="PanRight",e.TiltUp="TiltUp",e.TiltDown="TiltDown"}(t=e.ControlCommand||(e.ControlCommand={})),function(e){e[e.CommandResetError=0]="CommandResetError",e[e.CommandZoomInError=1]="CommandZoomInError",e[e.CommandZoomOutError=2]="CommandZoomOutError",e[e.CommandPanLeftError=3]="CommandPanLeftError",e[e.CommandPanRightError=4]="CommandPanRightError",e[e.CommandTiltUpError=5]="CommandTiltUpError",e[e.CommandTiltDownError=6]="CommandTiltDownError",e[e.SendDataError=7]="SendDataError"}(n=e.ErrorReason||(e.ErrorReason={})),function(e){e[e.None=0]="None",e[e.ControlDenied=1]="ControlDenied",e[e.ControlNoResponse=2]="ControlNoResponse",e[e.ControlBusy=3]="ControlBusy",e[e.AckTimeout=4]="AckTimeout",e[e.ControlTerminated=5]="ControlTerminated",e[e.ControllerTerminated=6]="ControllerTerminated",e[e.DataChannelError=7]="DataChannelError",e[e.ControllerCancelled=8]="ControllerCancelled",e[e.ControlDisabled=9]="ControlDisabled",e[e.ControlTerminatedToAllowOtherController=10]="ControlTerminatedToAllowOtherController"}(a=e.SessionTerminatedReason||(e.SessionTerminatedReason={})),e.getCapableParticipants=function(e){if(!e)throw new Error("[remoteCamera.getCapableParticipants] Callback cannot be null");if(Ze(Ue,de.sidePanel),!r())throw _e;vn(i(pa,"remoteCamera.getCapableParticipants"),"remoteCamera.getCapableParticipants",e)},e.requestControl=function(e,t){if(!e)throw new Error("[remoteCamera.requestControl] Participant cannot be null");if(!t)throw new Error("[remoteCamera.requestControl] Callback cannot be null");if(Ze(Ue,de.sidePanel),!r())throw _e;vn(i(pa,"remoteCamera.requestControl"),"remoteCamera.requestControl",[e],t)},e.sendControlCommand=function(e,t){if(!e)throw new Error("[remoteCamera.sendControlCommand] ControlCommand cannot be null");if(!t)throw new Error("[remoteCamera.sendControlCommand] Callback cannot be null");if(Ze(Ue,de.sidePanel),!r())throw _e;vn(i(pa,"remoteCamera.sendControlCommand"),"remoteCamera.sendControlCommand",[e],t)},e.terminateSession=function(e){if(!e)throw new Error("[remoteCamera.terminateSession] Callback cannot be null");if(Ze(Ue,de.sidePanel),!r())throw _e;vn(i(pa,"remoteCamera.terminateSession"),"remoteCamera.terminateSession",e)},e.registerOnCapableParticipantsChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnCapableParticipantsChangeHandler] Handler cannot be null");if(Ze(Ue,de.sidePanel),!r())throw _e;Yt(i(pa,"remoteCamera.registerOnCapableParticipantsChangeHandler"),"remoteCamera.capableParticipantsChange",e)},e.registerOnErrorHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnErrorHandler] Handler cannot be null");if(Ze(Ue,de.sidePanel),!r())throw _e;Yt(i(pa,"remoteCamera.registerOnErrorHandler"),"remoteCamera.handlerError",e)},e.registerOnDeviceStateChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnDeviceStateChangeHandler] Handler cannot be null");if(Ze(Ue,de.sidePanel),!r())throw _e;Yt(i(pa,"remoteCamera.registerOnDeviceStateChangeHandler"),"remoteCamera.deviceStateChange",e)},e.registerOnSessionStatusChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnSessionStatusChangeHandler] Handler cannot be null");if(Ze(Ue,de.sidePanel),!r())throw _e;Yt(i(pa,"remoteCamera.registerOnSessionStatusChangeHandler"),"remoteCamera.sessionStatusChange",e)},e.isSupported=r}(ma||(ma={})),function(e){function t(){return!(!Ze(Ue)||!Ue.supports.appEntity)}e.selectAppEntity=function(e,n,a,r){if(Ze(Ue,de.content),!t())throw _e;if(!e||0==e.length)throw new Error("[appEntity.selectAppEntity] threadId name cannot be null or empty");if(!r)throw new Error("[appEntity.selectAppEntity] Callback cannot be null");vn(i("v1","appEntity.selectAppEntity"),"appEntity.selectAppEntity",[e,n,a],r)},e.isSupported=t}(_a||(_a={}));const ha="v1";var ba;!function(e){let t,n;function a(){return!(!Ze(Ue)||!Ue.supports.teams)}!function(e){e[e.Regular=0]="Regular",e[e.Private=1]="Private",e[e.Shared=2]="Shared"}(t=e.ChannelType||(e.ChannelType={})),e.getTeamChannels=function(e,t){if(Ze(Ue,de.content),!a())throw _e;if(!e)throw new Error("[teams.getTeamChannels] groupId cannot be null or empty");if(!t)throw new Error("[teams.getTeamChannels] Callback cannot be null");vn(i(ha,"teams.getTeamChannels"),"teams.getTeamChannels",[e],t)},e.refreshSiteUrl=function(e,t){if(Ze(Ue),!a())throw _e;if(!e)throw new Error("[teams.refreshSiteUrl] threadId cannot be null or empty");if(!t)throw new Error("[teams.refreshSiteUrl] Callback cannot be null");vn(i(ha,"teams.refreshSiteUrl"),"teams.refreshSiteUrl",[e],t)},e.isSupported=a,function(e){let t;function n(){return!(!Ze(Ue)||!Ue.supports.teams||!Ue.supports.teams.fullTrust)}!function(e){function t(){return!!(Ze(Ue)&&Ue.supports.teams&&Ue.supports.teams.fullTrust&&Ue.supports.teams.fullTrust.joinedTeams)}e.getUserJoinedTeams=function(e){return new Promise(n=>{if(Ze(Ue),!t())throw _e;if((b.hostClientType===se.android||b.hostClientType===se.teamsRoomsAndroid||b.hostClientType===se.teamsPhones||b.hostClientType===se.teamsDisplays)&&!$e("2.0.1")){const e={errorCode:ie.OLD_PLATFORM};throw new Error(JSON.stringify(e))}n(pn(i(ha,"teams.fullTrust.joinedTeams.getUserJoinedTeams"),"getUserJoinedTeams",e))})},e.isSupported=t}(t=e.joinedTeams||(e.joinedTeams={})),e.getConfigSetting=function(e){return new Promise(t=>{if(Ze(Ue),!n())throw _e;t(pn(i(ha,"teams.fullTrust.getConfigSetting"),"getConfigSetting",e))})},e.isSupported=n}(n=e.fullTrust||(e.fullTrust={}))}(ba||(ba={}));class ga{static setTimeout(e,t){const n=performance.now(),a=Se();return ga.setTimeoutCallbacks[a]={callback:e,timeoutInMs:t,startedAtInMs:n},a}static clearTimeout(e){delete ga.setTimeoutCallbacks[e]}static setInterval(e,t){ga.setTimeout(function n(){e(),ga.setTimeout(n,t)},t)}static tick(){const e=performance.now(),t=[];for(const n in ga.setTimeoutCallbacks){const a=ga.setTimeoutCallbacks[n];e-a.startedAtInMs>=a.timeoutInMs&&t.push(n)}for(const e of t)ga.setTimeoutCallbacks[e].callback(),delete ga.setTimeoutCallbacks[e]}}ga.setTimeoutCallbacks={};class va{constructor(e,t){this.reportStatisticsResult=t,this.sampleCount=0,this.distributionBins=new Uint32Array(e)}processStarts(e,t,n,a){ga.tick(),this.suitableForThisSession(e,t,n,a)||this.reportAndResetSession(this.getStatistics(),e,a,t,n),this.start()}processEnds(){const e=performance.now()-this.frameProcessingStartedAt,t=Math.floor(Math.max(0,Math.min(this.distributionBins.length-1,e)));this.distributionBins[t]+=1,this.sampleCount+=1}getStatistics(){return this.currentSession?{effectId:this.currentSession.effectId,effectParam:this.currentSession.effectParam,frameHeight:this.currentSession.frameHeight,frameWidth:this.currentSession.frameWidth,duration:performance.now()-this.currentSession.startedAtInMs,sampleCount:this.sampleCount,distributionBins:this.distributionBins.slice()}:null}start(){this.frameProcessingStartedAt=performance.now()}suitableForThisSession(e,t,n,a){return this.currentSession&&this.currentSession.effectId===e&&this.currentSession.effectParam===a&&this.currentSession.frameWidth===t&&this.currentSession.frameHeight===n}reportAndResetSession(e,t,n,a,i){e&&this.reportStatisticsResult(e),this.resetCurrentSession(this.getNextTimeout(t,this.currentSession),t,n,a,i),this.timeoutId&&ga.clearTimeout(this.timeoutId),this.timeoutId=ga.setTimeout((()=>this.reportAndResetSession(this.getStatistics(),t,n,a,i)).bind(this),this.currentSession.timeoutInMs)}resetCurrentSession(e,t,n,a,i){this.currentSession={startedAtInMs:performance.now(),timeoutInMs:e,effectId:t,effectParam:n,frameWidth:a,frameHeight:i},this.sampleCount=0,this.distributionBins.fill(0)}getNextTimeout(e,t){return t&&t.effectId===e?Math.min(va.maxSessionTimeoutInMs,2*t.timeoutInMs):va.initialSessionTimeoutInMs}}va.initialSessionTimeoutInMs=1e3,va.maxSessionTimeoutInMs=3e4;const ya="v2";class Sa{constructor(e){this.reportPerformanceEvent=e,this.isFirstFrameProcessed=!1,this.frameProcessTimeLimit=100,this.frameProcessingStartedAt=0,this.frameProcessingTimeCost=0,this.processedFrameCount=0,this.performanceStatistics=new va(Sa.distributionBinSize,e=>this.reportPerformanceEvent(i(ya,"videoPerformanceMonitor.performanceDataGenerated"),"video.performance.performanceDataGenerated",[e]))}startMonitorSlowFrameProcessing(){ga.setInterval(()=>{if(0===this.processedFrameCount)return;const e=this.frameProcessingTimeCost/this.processedFrameCount;e>this.frameProcessTimeLimit&&this.reportPerformanceEvent(i(ya,"videoPerformanceMonitor.startMonitorSlowFrameProcessing"),"video.performance.frameProcessingSlow",[e]),this.frameProcessingTimeCost=0,this.processedFrameCount=0},Sa.calculateFPSInterval)}setFrameProcessTimeLimit(e){this.frameProcessTimeLimit=e}reportApplyingVideoEffect(e,t){var n,a;(null===(n=this.applyingEffect)||void 0===n?void 0:n.effectId)===e&&(null===(a=this.applyingEffect)||void 0===a?void 0:a.effectParam)===t||(this.applyingEffect={effectId:e,effectParam:t},this.appliedEffect=void 0)}reportVideoEffectChanged(e,t){void 0===this.applyingEffect||this.applyingEffect.effectId!==e&&this.applyingEffect.effectParam!==t||(this.appliedEffect={effectId:e,effectParam:t},this.applyingEffect=void 0,this.isFirstFrameProcessed=!1)}reportStartFrameProcessing(e,t){ga.tick(),this.appliedEffect&&(this.frameProcessingStartedAt=performance.now(),this.performanceStatistics.processStarts(this.appliedEffect.effectId,e,t,this.appliedEffect.effectParam))}reportFrameProcessed(){var e;this.appliedEffect&&(this.processedFrameCount++,this.frameProcessingTimeCost+=performance.now()-this.frameProcessingStartedAt,this.performanceStatistics.processEnds(),this.isFirstFrameProcessed||(this.isFirstFrameProcessed=!0,this.reportPerformanceEvent(i(ya,"videoPerformanceMonitor.reportFrameProcessed"),"video.performance.firstFrameProcessed",[Date.now(),this.appliedEffect.effectId,null===(e=this.appliedEffect)||void 0===e?void 0:e.effectParam])))}reportGettingTextureStream(e){this.gettingTextureStreamStartedAt=performance.now(),this.currentStreamId=e}reportTextureStreamAcquired(){if(void 0!==this.gettingTextureStreamStartedAt){const e=performance.now()-this.gettingTextureStreamStartedAt;this.reportPerformanceEvent(i(ya,"videoPerformanceMonitor.reportTextureStreamAcquired"),"video.performance.textureStreamAcquired",[this.currentStreamId,e])}}}Sa.distributionBinSize=1e3,Sa.calculateFPSInterval=1e3;var Da=function(e,t,n,a){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((a=a.apply(e,t||[])).next())})};const Ia="v2";var xa;!function(e){const t=we()?void 0:new Sa(vn);let n,a,r;function o(e){vn(i(Ia,"videoEffects.notifyError"),"video.notifyError",[e])}function s(){return Ze(Ue)&&!!Ue.supports.video&&(!!Ue.supports.video.mediaStream||!!Ue.supports.video.sharedFrame)}function c(){var e;return Ze(Ue,de.sidePanel)&&function(){var e,t,n,a;return!(!(null===(t=null===(e=Oe().chrome)||void 0===e?void 0:e.webview)||void 0===t?void 0:t.getTextureStream)||!(null===(a=null===(n=Oe().chrome)||void 0===n?void 0:n.webview)||void 0===a?void 0:a.registerTextureStream))}()&&!!(null===(e=Ue.supports.video)||void 0===e?void 0:e.mediaStream)}function d(){var e;return Ze(Ue,de.sidePanel)&&!!(null===(e=Ue.supports.video)||void 0===e?void 0:e.sharedFrame)}!function(e){e.NV12="NV12"}(n=e.VideoFrameFormat||(e.VideoFrameFormat={})),function(e){e.EffectChanged="EffectChanged",e.EffectDisabled="EffectDisabled"}(a=e.EffectChangeType||(e.EffectChangeType={})),function(e){e.InvalidEffectId="InvalidEffectId",e.InitializationFailure="InitializationFailure"}(r=e.EffectFailureReason||(e.EffectFailureReason={})),e.registerForVideoFrame=function(e){if(Ze(Ue,de.sidePanel),!s())throw _e;if(!e.videoFrameHandler||!e.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(Yt(i(Ia,"videoEffects.setFrameProcessTimeLimitHandler"),"video.setFrameProcessTimeLimit",e=>null==t?void 0:t.setFrameProcessTimeLimit(e.timeLimit),!1),c())!function(e,n){if(Ze(Ue,de.sidePanel),!s()||!c())throw _e;Yt(i(Ia,"videoEffects.startVideoExtensibilityVideoStreamHandler"),"video.startVideoExtensibilityVideoStream",n=>Da(this,void 0,void 0,function*(){const{streamId:a}=n,i=function(e,t){return n=>Da(this,void 0,void 0,function*(){const a=n.videoFrame;null==t||t.reportStartFrameProcessing(a.codedWidth,a.codedHeight);const i=yield e(n);return null==t||t.reportFrameProcessed(),i})}(e,t);yield wa(a,i,o,t)}),!1),vn(i(Ia,"videoEffects.mediaStream.registerForVideoFrame"),"video.mediaStream.registerForVideoFrame",[n])}(e.videoFrameHandler,e.config);else{if(!d())throw _e;!function(e,n){if(Ze(Ue,de.sidePanel),!s()||!d())throw _e;Yt(i(Ia,"videoEffects.registerForVideoBufferHandler"),"video.newVideoFrame",n=>{if(n){const a=n.timestamp;null==t||t.reportStartFrameProcessing(n.width,n.height),e(function(e){if("videoFrameBuffer"in e)return e;{const{data:t}=e,n=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(e,["data"]);return Object.assign(Object.assign({},n),{videoFrameBuffer:t})}}(n),()=>{null==t||t.reportFrameProcessed(),function(e){vn(i(Ia,"videoEffects.notifyVideoFrameProcessed"),"video.videoFrameProcessed",[e])}(a)},o)}},!1),vn(i(Ia,"videoEffects.registerForVideoFrame"),"video.registerForVideoFrame",[n])}(e.videoBufferHandler,e.config)}null==t||t.startMonitorSlowFrameProcessing()},e.notifySelectedVideoEffectChanged=function(e,t){if(Ze(Ue,de.sidePanel),!s())throw _e;vn(i(Ia,"videoEffects.notifySelectedVideoEffectChanged"),"video.videoEffectChanged",[e,t])},e.registerForVideoEffect=function(e){if(Ze(Ue,de.sidePanel),!s())throw _e;Yt(i(Ia,"videoEffects.registerEffectParameterChangeHandler"),"video.effectParameterChange",Ua(e,t),!1),vn(i(Ia,"videoEffects.registerForVideoEffect"),"video.registerForVideoEffect")},e.isSupported=s}(xa||(xa={}));var Ca=function(e,t,n,a){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((a=a.apply(e,t||[])).next())})};const Oa="v2";function wa(e,t,n,a){var i,r;return Ca(this,void 0,void 0,function*(){const o=Aa();!we()&&(null===(r=null===(i=window.chrome)||void 0===i?void 0:i.webview)||void 0===r||r.registerTextureStream(e,o)),La(yield Ea(e,n,a),new ka(n,t),o.writable)})}function Ea(e,t,n){return Ca(this,void 0,void 0,function*(){if(we())throw _e;const a=Oe().chrome;try{null==n||n.reportGettingTextureStream(e);const t=(yield a.webview.getTextureStream(e)).getVideoTracks();if(0===t.length)throw new Error(`No video track in stream ${e}`);return null==n||n.reportTextureStreamAcquired(),t[0]}catch(n){throw t(`Failed to get video track from stream ${e}, error: ${n}`),new Error(`Internal error: can't get video track from stream ${e}`)}})}function Aa(){if(we())throw _e;const e=window.MediaStreamTrackGenerator;if(!e)throw _e;return new e({kind:"video"})}function La(e,t,n){new(0,Oe().MediaStreamTrackProcessor)({track:e}).readable.pipeThrough(new TransformStream(t)).pipeTo(n)}class ka{constructor(e,t){this.notifyError=e,this.videoFrameHandler=t,this.transform=(e,t)=>Ca(this,void 0,void 0,function*(){const n=e.timestamp;if(null!==n)try{const a=yield this.videoFrameHandler({videoFrame:e}),i=new VideoFrame(a,{timestamp:n});t.enqueue(i),e.close(),a.close()}catch(t){e.close(),this.notifyError(t)}else this.notifyError("timestamp of the original video frame is null")})}}class Ma{constructor(e,t){if(this.headerBuffer=e,this.notifyError=t,this.ONE_TEXTURE_INPUT_ID=1869900081,this.INVALID_HEADER_ERROR="Invalid video frame header",this.UNSUPPORTED_LAYOUT_ERROR="Unsupported texture layout",this.headerDataView=new Uint32Array(e),this.headerDataView.length<8)throw this.notifyError(this.INVALID_HEADER_ERROR),new Error(this.INVALID_HEADER_ERROR);if(this.headerDataView[0]!==this.ONE_TEXTURE_INPUT_ID)throw this.notifyError(this.UNSUPPORTED_LAYOUT_ERROR),new Error(this.UNSUPPORTED_LAYOUT_ERROR)}get oneTextureLayoutId(){return this.headerDataView[0]}get version(){return this.headerDataView[1]}get frameRowOffset(){return this.headerDataView[2]}get frameFormat(){return this.headerDataView[3]}get frameWidth(){return this.headerDataView[4]}get frameHeight(){return this.headerDataView[5]}get multiStreamHeaderRowOffset(){return this.headerDataView[6]}get multiStreamCount(){return this.headerDataView[7]}}class Pa{constructor(e,t){this.metadataMap=new Map,this.AUDIO_INFERENCE_RESULT_STREAM_ID=828664161;const n=new Uint32Array(e);for(let a=0,i=0;a<t;a++){const t=n[i++],a=n[i++],r=n[i++],o=new Uint8Array(e,a,r);this.metadataMap.set(t,o)}}get audioInferenceResult(){return this.metadataMap.get(this.AUDIO_INFERENCE_RESULT_STREAM_ID)}}class Ta{constructor(e,t){this.notifyError=e,this.videoFrameHandler=t,this.shouldDiscardAudioInferenceResult=!1,this.transform=(e,t)=>Ca(this,void 0,void 0,function*(){const n=e.timestamp;if(null!==n)try{const{videoFrame:a,metadata:{audioInferenceResult:i}={}}=yield this.extractVideoFrameAndMetadata(e),r=yield this.videoFrameHandler({videoFrame:a,audioInferenceResult:i}),o=new VideoFrame(r,{timestamp:n});t.enqueue(o),a.close(),e.close(),r.close()}catch(t){e.close(),this.notifyError(t)}else this.notifyError("timestamp of the original video frame is null")}),this.extractVideoFrameAndMetadata=e=>Ca(this,void 0,void 0,function*(){if(we())throw _e;if("NV12"!==e.format)throw this.notifyError("Unsupported video frame pixel format"),new Error("Unsupported video frame pixel format");const t={x:0,y:0,width:e.codedWidth,height:2},n=new ArrayBuffer(t.width*t.height*3/2);yield e.copyTo(n,{rect:t});const a=new Ma(n,this.notifyError),i={x:0,y:a.multiStreamHeaderRowOffset,width:e.codedWidth,height:e.codedHeight-a.multiStreamHeaderRowOffset},r=new ArrayBuffer(i.width*i.height*3/2);yield e.copyTo(r,{rect:i});const o=new Pa(r,a.multiStreamCount);return{videoFrame:new VideoFrame(e,{timestamp:e.timestamp,visibleRect:{x:0,y:a.frameRowOffset,width:a.frameWidth,height:a.frameHeight}}),metadata:{audioInferenceResult:this.shouldDiscardAudioInferenceResult?void 0:o.audioInferenceResult}}}),Yt(i(Oa,"videoEffectsUtils.transformerWithMetadata.constructor"),"video.mediaStream.audioInferenceDiscardStatusChange",({discardAudioInferenceResult:e})=>{this.shouldDiscardAudioInferenceResult=e})}}function Ua(e,t){return(n,a)=>{null==t||t.reportApplyingVideoEffect(n||"",a),e(n,a).then(()=>{null==t||t.reportVideoEffectChanged(n||"",a),vn(i(Oa,"videoEffectsUtils.reportVideoEffectChanged"),"video.videoEffectReadiness",[!0,n,void 0,a])}).catch(e=>{const t=e in xa.EffectFailureReason?e:xa.EffectFailureReason.InitializationFailure;vn(i(Oa,"videoEffectsUtils.effectFailure"),"video.videoEffectReadiness",[!1,n,t,a])})}}var Fa=function(e,t,n,a){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((a=a.apply(e,t||[])).next())})};const Ha="v2";var Ra,Na;function Ba(e,t,n){if(0===e.length)throw new Error("Must have at least one user when creating a chat deep link");const a="users="+e.map(e=>encodeURIComponent(e)).join(","),i=void 0===t?"":`&topicName=${encodeURIComponent(t)}`,r=void 0===n?"":`&message=${encodeURIComponent(n)}`;return`${m}://${_}/l/chat/0/0?${a}${i}${r}`}!function(e){e.frameProcessingTimeoutInMs=2e3;const t=we()?void 0:new Sa(vn);let n;function a(){const t=setTimeout(()=>{c(`Frame not processed in ${e.frameProcessingTimeoutInMs}ms`,n.Warn)},e.frameProcessingTimeoutInMs);return function(){clearTimeout(t)}}function r(e,t){return n=>Fa(this,void 0,void 0,function*(){const i=n.videoFrame;t.reportStartFrameProcessing(i.codedWidth,i.codedHeight);const r=a(),o=yield e(n);return r(),t.reportFrameProcessed(),o})}function o(){return Ze(Ue),xa.isSupported()}function s(e){vn(i(Ha,"videoEffectsEx.notifyVideoFrameProcessed"),"video.videoFrameProcessed",[e])}function c(e,t=n.Warn){vn(i(Ha,"videoEffectsEx.notifyError"),"video.notifyError",[e,t])}!function(e){e.Fatal="fatal",e.Warn="warn"}(n=e.ErrorLevel||(e.ErrorLevel={})),e.registerForVideoFrame=function(e){var n,d;if(!o())throw _e;if(!e.videoFrameHandler||!e.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(Ze(Ue,de.sidePanel)){if(Yt(i(Ha,"videoEffectsEX.registerSetFrameProcessTimeLimitHandler"),"video.setFrameProcessTimeLimit",e=>null==t?void 0:t.setFrameProcessTimeLimit(e),!1),null===(n=Ue.supports.video)||void 0===n?void 0:n.mediaStream)Yt(i(Ha,"videoEffectsEX.registerStartVideoExtensibilityVideoStreamHandler"),"video.startVideoExtensibilityVideoStream",n=>Fa(this,void 0,void 0,function*(){const{streamId:a,metadataInTexture:i}=n,o=t?r(e.videoFrameHandler,t):e.videoFrameHandler;i?yield function(e,t,n,a){var i,r;return Ca(this,void 0,void 0,function*(){const o=Aa();!we()&&(null===(r=null===(i=window.chrome)||void 0===i?void 0:i.webview)||void 0===r||r.registerTextureStream(e,o)),La(yield Ea(e,n,a),new Ta(n,t),o.writable)})}(a,o,c,t):yield wa(a,o,c,t)}),!1),vn(i(Ha,"videoEffectsEX.mediaStream.registerForVideoFrame"),"video.mediaStream.registerForVideoFrame",[e.config]);else{if(!(null===(d=Ue.supports.video)||void 0===d?void 0:d.sharedFrame))throw _e;Yt(i(Ha,"videoEffectsEx.registerNewVideoFrameHandler"),"video.newVideoFrame",n=>{if(n){null==t||t.reportStartFrameProcessing(n.width,n.height);const i=a(),r=n.timestamp;e.videoBufferHandler(function(e){return e.videoFrameBuffer=e.videoFrameBuffer||e.data,delete e.data,e}(n),()=>{i(),null==t||t.reportFrameProcessed(),s(r)},c)}},!1),vn(i(Ha,"videoEffectsEx.registerForVideoFrame"),"video.registerForVideoFrame",[e.config])}null==t||t.startMonitorSlowFrameProcessing()}},e.notifySelectedVideoEffectChanged=function(e,t,n){if(Ze(Ue,de.sidePanel),!o())throw _e;vn(i(Ha,"videoEffectsEx.notifySelectedVideoEffectChanged"),"video.videoEffectChanged",[e,t,n])},e.registerForVideoEffect=function(e){if(Ze(Ue,de.sidePanel),!o())throw _e;Yt(i(Ha,"videoEffectsEx.registerEffectParamterChangeHandler"),"video.effectParameterChange",Ua(e,t),!1),vn(i(Ha,"videoEffectsEx.registerForVideoEffect"),"video.registerForVideoEffect")},e.updatePersonalizedEffects=function(e){if(Ze(Ue,de.sidePanel),!xa.isSupported())throw _e;vn(i(Ha,"videoEffectsEx.updatePersonalizedEffects"),"video.personalizedEffectsChanged",[e])},e.isSupported=o,e.notifyFatalError=function(e){if(Ze(Ue),!xa.isSupported())throw _e;c(e,n.Fatal)}}(Ra||(Ra={})),function(e){function t(){return!(!Ze(Ue)||!Ue.supports.appInstallDialog)}e.openAppInstallDialog=function(e){return new Promise(n=>{if(Ze(Ue,de.content,de.sidePanel,de.settings,de.task,de.stage,de.meetingStage),!t())throw new Error("Not supported");const a=i("v1","appInstallDialog.openAppInstallDialog");Ue.isLegacyTeams?n(mn(a,"executeDeepLink",function(e){if(!e)throw new Error("App ID must be set when creating an app install dialog deep link");return`${m}://${_}/l/app/${encodeURIComponent(e)}`}(e.appId))):(vn(a,"appInstallDialog.openAppInstallDialog",[e]),n())})},e.isSupported=t}(Na||(Na={}));const ja="v1",Va=t("media");var za;function Ga(e,t){if(null==e||null==t||e.length<=0)return null;let n=null,a=1;return e.sort((e,t)=>e.sequence>t.sequence?1:-1),e.forEach(e=>{e.sequence==a&&(n=n?new Blob([n,e.file],{type:t}):new Blob([e.file],{type:t}),a++)}),n}function Ka(e,t){if(null==e||null==t)return null;const n=atob(e.chunk),a=new Array(n.length);for(let e=0;e<n.length;e++)a[e]=n.charCodeAt(e);const i=new Uint8Array(a),r=new Blob([i],{type:t});return{sequence:e.chunkSequence,file:r}}function Wa(e){return!e||!(null===e.timeOutIntervalInSec||null!=e.timeOutIntervalInSec&&e.timeOutIntervalInSec<=0||null!=e.timeOutIntervalInSec&&e.timeOutIntervalInSec>60)}!function(e){let t,n,a,r,o,s,d;!function(e){e.Base64="base64",e.ID="id"}(t=e.FileFormat||(e.FileFormat={}));class u{}function f(){return!(!Ze(Ue)||!Ue.supports.permissions)}e.File=u,e.captureImage=function(e){if(!e)throw new Error("[captureImage] Callback cannot be null");Ze(Ue,de.content,de.task),b.isFramelessWindow?$e("1.7.0")?vn(i(ja,"media.captureImage"),"captureImage",e):e({errorCode:ie.OLD_PLATFORM},[]):e({errorCode:ie.NOT_SUPPORTED_ON_PLATFORM},[])},e.hasPermission=function(){if(Ze(Ue,de.content,de.task),!f())throw _e;const e=re.Media;return new Promise(t=>{t(hn(i(ja,"media.hasPermission"),"permissions.has",e))})},e.requestPermission=function(){if(Ze(Ue,de.content,de.task),!f())throw _e;const e=re.Media;return new Promise(t=>{t(hn(i(ja,"media.requestPermission"),"permissions.request",e))})};class p extends u{constructor(e){super(),e&&(this.content=e.content,this.format=e.format,this.mimeType=e.mimeType,this.name=e.name,this.preview=e.preview,this.size=e.size)}getMedia(e){if(!e)throw new Error("[get Media] Callback cannot be null");Ze(Ue,de.content,de.task),$e(l)?function(e,t,n){return null!=e&&null!=t&&t==za.FileFormat.ID&&null!=n}(this.mimeType,this.format,this.content)?$e("2.0.0")?this.getMediaViaCallback(e):this.getMediaViaHandler(e):e({errorCode:ie.INVALID_ARGUMENTS},new Blob):e({errorCode:ie.OLD_PLATFORM},new Blob)}getMediaViaCallback(e){const t={mediaMimeType:this.mimeType,assembleAttachment:[]},n=[this.content];vn(i(ja,"media.getMedia"),"getMedia",n,function(n){if(e)if(n&&n.error)e(n.error,new Blob);else if(n&&n.mediaChunk)if(n.mediaChunk.chunkSequence<=0){const a=Ga(t.assembleAttachment,t.mediaMimeType);e(n.error,null!=a?a:new Blob)}else{const e=Ka(n.mediaChunk,t.mediaMimeType);e?t.assembleAttachment.push(e):Va(`Received a null assemble attachment for when decoding chunk sequence ${n.mediaChunk.chunkSequence}; not including the chunk in the assembled file.`)}else e({errorCode:ie.INTERNAL_ERROR,message:"data received is null"},new Blob)})}getMediaViaHandler(e){const t=Se(),n={mediaMimeType:this.mimeType,assembleAttachment:[]},a=[t,this.content];this.content&&!tt(e)&&vn(i(ja,"media.getMedia"),"getMedia",a),Yt(i(ja,"media.registerGetMediaRequestHandler"),"getMedia"+t,function(a){if(e){const i=JSON.parse(a);if(i.error)e(i.error,new Blob),Jt("getMedia"+t);else if(i.mediaChunk)if(i.mediaChunk.chunkSequence<=0){const a=Ga(n.assembleAttachment,n.mediaMimeType);e(i.error,null!=a?a:new Blob),Jt("getMedia"+t)}else{const e=Ka(i.mediaChunk,n.mediaMimeType);e&&n.assembleAttachment.push(e)}else e({errorCode:ie.INTERNAL_ERROR,message:"data received is null"},new Blob),Jt("getMedia"+t)}})}}e.Media=p,e.VideoController=class extends class{constructor(e){this.controllerCallback=e}notifyEventToHost(e,t){Ze(Ue,de.content,de.task);try{et(c)}catch(e){return void(t&&t(e))}const n={mediaType:this.getMediaType(),mediaControllerEvent:e};vn(i(ja,"media.controller"),"media.controller",[n],e=>{t&&t(e)})}stop(e){this.notifyEventToHost(n.StopRecording,e)}}{getMediaType(){return o.Video}notifyEventToApp(e){if(this.controllerCallback)switch(e){case n.StartRecording:if(this.controllerCallback.onRecordingStarted){this.controllerCallback.onRecordingStarted();break}}}},function(e){e[e.StartRecording=1]="StartRecording",e[e.StopRecording=2]="StopRecording"}(n=e.MediaControllerEvent||(e.MediaControllerEvent={})),function(e){e[e.Photo=1]="Photo",e[e.Document=2]="Document",e[e.Whiteboard=3]="Whiteboard",e[e.BusinessCard=4]="BusinessCard"}(a=e.CameraStartMode||(e.CameraStartMode={})),function(e){e[e.Camera=1]="Camera",e[e.Gallery=2]="Gallery"}(r=e.Source||(e.Source={})),function(e){e[e.Image=1]="Image",e[e.Video=2]="Video",e[e.VideoAndImage=3]="VideoAndImage",e[e.Audio=4]="Audio"}(o=e.MediaType||(e.MediaType={})),function(e){e[e.ID=1]="ID",e[e.URL=2]="URL"}(s=e.ImageUriType||(e.ImageUriType={})),function(e){e[e.IMAGE=1]="IMAGE",e[e.PDF=2]="PDF"}(d=e.ImageOutputFormats||(e.ImageOutputFormats={})),e.selectMedia=function(e,t){if(!t)throw new Error("[select Media] Callback cannot be null");if(Ze(Ue,de.content,de.task),!$e(l)){const e={errorCode:ie.OLD_PLATFORM};return void t(e,[])}try{!function(e){!function(e){return!(!e||e.mediaType!=za.MediaType.VideoAndImage&&!e.videoAndImageProps)}(e)?function(e){return!(!e||e.mediaType!=za.MediaType.Video||!e.videoProps||e.videoProps.isFullScreenMode)}(e)?et(c):function(e){var t;return!((null==e?void 0:e.mediaType)!=za.MediaType.Image||!(null===(t=null==e?void 0:e.imageProps)||void 0===t?void 0:t.imageOutputFormats))}(e)&&et("2.0.4"):et("2.0.2")}(e)}catch(e){return void t(e,[])}if(!function(e){return!(null==e||e.maxMediaCount>10)}(e)){const e={errorCode:ie.INVALID_ARGUMENTS};return void t(e,[])}const n=[e];vn(i(ja,"media.selectMedia"),"selectMedia",n,(n,a,i)=>{var r,o;if(i)return void(function(e){return!(e.mediaType!=za.MediaType.Video||!e.videoProps||!e.videoProps.videoController)}(e)&&(null===(o=null===(r=null==e?void 0:e.videoProps)||void 0===r?void 0:r.videoController)||void 0===o||o.notifyEventToApp(i)));if(!a)return void t(n,[]);const s=[];for(const e of a)s.push(new p(e));t(n,s)})},e.viewImages=function(e,t){if(!t)throw new Error("[view images] Callback cannot be null");if(Ze(Ue,de.content,de.task),!$e(l))return void t({errorCode:ie.OLD_PLATFORM});if(!function(e){return!(null==e||e.length<=0||e.length>10)}(e))return void t({errorCode:ie.INVALID_ARGUMENTS});const n=[e];vn(i(ja,"media.viewImages"),"viewImages",n,t)},e.scanBarCode=function(e,t){if(!e)throw new Error("[media.scanBarCode] Callback cannot be null");Ze(Ue,de.content,de.task),b.hostClientType!==se.desktop&&b.hostClientType!==se.web&&b.hostClientType!==se.rigel&&b.hostClientType!==se.teamsRoomsWindows&&b.hostClientType!==se.teamsRoomsAndroid&&b.hostClientType!==se.teamsPhones&&b.hostClientType!==se.teamsDisplays?$e("1.9.0")?Wa(t)?vn(i(ja,"media.scanBarCode"),"media.scanBarCode",[t],e):e({errorCode:ie.INVALID_ARGUMENTS},""):e({errorCode:ie.OLD_PLATFORM},""):e({errorCode:ie.NOT_SUPPORTED_ON_PLATFORM},"")}}(za||(za={}));const qa="v2";var Qa,Ya;!function(e){function t(){return!!(Ze(Ue)&&Ue.supports.barCode&&Ue.supports.permissions)}e.scanBarCode=function(e){return new Promise(n=>{if(Ze(Ue,de.content,de.task),!t())throw _e;if(!Wa(e))throw{errorCode:ie.INVALID_ARGUMENTS};n(hn(i(qa,"barCode.scanBarCode"),"media.scanBarCode",e))})},e.hasPermission=function(){if(Ze(Ue,de.content,de.task),!t())throw _e;const e=re.Media;return new Promise(t=>{t(hn(i(qa,"barCode.hasPermission"),"permissions.has",e))})},e.requestPermission=function(){if(Ze(Ue,de.content,de.task),!t())throw _e;const e=re.Media;return new Promise(t=>{t(hn(i(qa,"barCode.requestPermission"),"permissions.request",e))})},e.isSupported=t}(Qa||(Qa={})),function(e){function t(e,t){return new Promise(a=>{if(Ze(Ue,de.content,de.task),!n())throw _e;Ue.isLegacyTeams?a(mn(e,"executeDeepLink",Ba([t.user],void 0,t.message))):a(mn(e,"chat.openChat",{members:[t.user],message:t.message}))})}function n(){return!(!Ze(Ue)||!Ue.supports.chat)}e.openChat=function(e){return t(i("v2","chat.openChat"),e)},e.openGroupChat=function(e){const a=i("v2","chat.openGroupChat");return new Promise(i=>{if(e.users.length<1)throw Error("OpenGroupChat Failed: No users specified");if(1===e.users.length){const n={user:e.users[0],message:e.message};i(t(a,n))}else{if(Ze(Ue,de.content,de.task),!n())throw _e;Ue.isLegacyTeams?i(mn(a,"executeDeepLink",Ba(e.users,e.topic,e.message))):i(mn(a,"chat.openChat",{members:e.users,message:e.message,topic:e.topic}))}})},e.isSupported=n}(Ya||(Ya={}));var Ja,Xa,Za=function(e,t,n,a){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((a=a.apply(e,t||[])).next())})};!function(e){function t(){return!!(Ze(Ue)&&navigator&&navigator.clipboard&&Ue.supports.clipboard)}e.write=function(e){return Za(this,void 0,void 0,function*(){if(Ze(Ue,de.content,de.meetingStage,de.task,de.settings,de.stage,de.sidePanel),!t())throw _e;if(!e.type||!Object.values(oe).includes(e.type))throw new Error(`Blob type ${e.type} is not supported. Supported blob types are ${Object.values(oe)}`);const n=yield function(e){return new Promise((t,n)=>{0===e.size&&n(new Error("Blob cannot be empty."));const a=new FileReader;a.onloadend=()=>{a.result?t(a.result.toString().split(",")[1]):n(new Error("Failed to read the blob"))},a.onerror=()=>{n(a.error)},a.readAsDataURL(e)})}(e),a={mimeType:e.type,content:n};return hn(i("v2","clipboard.write"),"clipboard.writeToClipboard",a)})},e.read=function(){return Za(this,void 0,void 0,function*(){Ze(Ue,de.content,de.meetingStage,de.task,de.settings,de.stage,de.sidePanel);const e=i("v2","clipboard.read");if(!t())throw _e;const n=yield hn(e,"clipboard.readFromClipboard");if("string"==typeof n){const e=JSON.parse(n);return function(e,t){return new Promise((n,a)=>{if(e||a("MimeType cannot be null or empty."),t||a("Base64 string cannot be null or empty."),e.startsWith("image/")){const a=atob(t),i=new Uint8Array(a.length);for(let e=0;e<a.length;e++)i[e]=a.charCodeAt(e);n(new Blob([i],{type:e}))}const i=v.from(t,"base64").toString();n(new Blob([i],{type:e}))})}(e.mimeType,e.content)}return n})},e.isSupported=t}(Ja||(Ja={})),function(e){e.isNAAChannelRecommended=function(){var e;return null!==(e=Ze(Ue)&&Ue.isNAAChannelRecommended)&&void 0!==e&&e}}(Xa||(Xa={}));const $a="v2";var ei;function ti(){return Ue.hostVersionsInfo?Ue.hostVersionsInfo.adaptiveCardSchemaVersion:void 0}!function(e){function t(){return!!(Ze(Ue)&&Ue.supports.geoLocation&&Ue.supports.permissions)}let n;e.getCurrentLocation=function(){if(Ze(Ue,de.content,de.task),!t())throw _e;return hn(i($a,"geoLocation.getCurrentLocation"),"location.getLocation",{allowChooseLocation:!1,showMap:!1})},e.hasPermission=function(){if(Ze(Ue,de.content,de.task),!t())throw _e;const e=re.GeoLocation;return new Promise(t=>{t(hn(i($a,"geoLocation.hasPermission"),"permissions.has",e))})},e.requestPermission=function(){if(Ze(Ue,de.content,de.task),!t())throw _e;const e=re.GeoLocation;return new Promise(t=>{t(hn(i($a,"geoLocation.requestPermission"),"permissions.request",e))})},e.isSupported=t,function(e){function t(){return!!(Ze(Ue)&&Ue.supports.geoLocation&&Ue.supports.geoLocation.map&&Ue.supports.permissions)}e.chooseLocation=function(){if(Ze(Ue,de.content,de.task),!t())throw _e;return hn(i($a,"geoLocation.map.chooseLocation"),"location.getLocation",{allowChooseLocation:!0,showMap:!0})},e.showLocation=function(e){if(Ze(Ue,de.content,de.task),!t())throw _e;if(!e)throw{errorCode:ie.INVALID_ARGUMENTS};return hn(i($a,"geoLocation.showLocation"),"location.showLocation",e)},e.isSupported=t}(n=e.map||(e.map={}))}(ei||(ei={}));const ni="v1";class ai{postMessage(e,t){Ze(Ue),vn(i(ni,"appWindow.childAppWindow.postMessage"),"messageForChild",[e],t||ve())}addEventListener(e,t){Ze(Ue),"message"===e&&Yt(i(ni,"appWindow.childAppWindow.addEventListener"),"messageForParent",t)}}class ii{static get Instance(){return this._instance||(this._instance=new this)}postMessage(e,t){Ze(Ue,de.task),vn(i(ni,"appWindow.parentAppWindow.postMessage"),"messageForParent",[e],t||ve())}addEventListener(e,t){Ze(Ue,de.task),"message"===e&&Yt(i(ni,"appWindow.parentAppWindow.addEventListener"),"messageForChild",t)}}var ri,oi;!function(e){function t(){return!(!Ze(Ue)||!Ue.supports.secondaryBrowser)}e.open=function(e){if(Ze(Ue,de.content),!t())throw _e;if(!e||!Ce(e))throw{errorCode:ie.INVALID_ARGUMENTS,message:"Invalid Url: Only https URL is allowed"};return hn(i("v2","secondaryBrowser.openUrl"),"secondaryBrowser.open",e.toString())},e.isSupported=t}(ri||(ri={})),function(e){function t(){return!(!Ze(Ue)||!Ue.supports.location)}e.getLocation=function(e,n){if(!n)throw new Error("[location.getLocation] Callback cannot be null");if(Ze(Ue,de.content,de.task),!$e(d))throw{errorCode:ie.OLD_PLATFORM};if(!e)throw{errorCode:ie.INVALID_ARGUMENTS};if(!t())throw _e;vn(i("v1","location.getLocation"),"location.getLocation",[e],n)},e.showLocation=function(e,n){if(!n)throw new Error("[location.showLocation] Callback cannot be null");if(Ze(Ue,de.content,de.task),!$e(d))throw{errorCode:ie.OLD_PLATFORM};if(!e)throw{errorCode:ie.INVALID_ARGUMENTS};if(!t())throw _e;vn(i("v1","location.showLocation"),"location.showLocation",[e],n)},e.isSupported=t}(oi||(oi={}));var si=function(e,t,n,a){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((a=a.apply(e,t||[])).next())})};const ci="v1";var di,li,ui,fi,pi,mi,_i;!function(e){let t,n,a,r,o,s,c;function d(e,n){vn(i(ci,"meeting.requestAppAudioHandling"),"meeting.requestAppAudioHandling",[e.isAppHandlingAudio],(a,r)=>{if(a&&null!=r)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(a)throw new Error(`[requestAppAudioHandling] Callback response - SDK error ${a.errorCode} ${a.message}`);if("boolean"!=typeof r)throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");Yt(i(ci,"meeting.registerMicStateChangeHandler"),"meeting.micStateChanged",n=>si(this,void 0,void 0,function*(){try{const a=yield e.micMuteStateChangedCallback(n);l(a,a.isMicMuted===n.isMicMuted?t.HostInitiated:t.AppDeclinedToChange)}catch(e){l(n,t.AppFailedToChange)}})),Yt(i(ci,"meeting.registerAudioDeviceSelectionChangedHandler"),"meeting.audioDeviceSelectionChanged",t=>{var n;null===(n=e.audioDeviceSelectionChangedCallback)||void 0===n||n.call(e,t)}),n(r)})}function l(e,t){Ze(Ue,de.sidePanel,de.meetingStage),vn(i(ci,"meeting.setMicStateWithReason"),"meeting.updateMicState",[e,t])}!function(e){e[e.HostInitiated=0]="HostInitiated",e[e.AppInitiated=1]="AppInitiated",e[e.AppDeclinedToChange=2]="AppDeclinedToChange",e[e.AppFailedToChange=3]="AppFailedToChange"}(t||(t={})),function(e){e.like="like",e.heart="heart",e.laugh="laugh",e.surprised="surprised",e.applause="applause"}(n=e.MeetingReactionType||(e.MeetingReactionType={})),function(e){e.Unknown="Unknown",e.Adhoc="Adhoc",e.Scheduled="Scheduled",e.Recurring="Recurring",e.Broadcast="Broadcast",e.MeetNow="MeetNow"}(a=e.MeetingType||(e.MeetingType={})),function(e){e.OneOnOneCall="oneOnOneCall",e.GroupCall="groupCall"}(r=e.CallType||(e.CallType={})),function(e){e.Collaborative="Collaborative",e.ScreenShare="ScreenShare"}(o=e.SharingProtocol||(e.SharingProtocol={})),e.getIncomingClientAudioState=function(e){if(!e)throw new Error("[get incoming client audio state] Callback cannot be null");Ze(Ue,de.sidePanel,de.meetingStage),vn(i(ci,"meeting.getIncomingClientAudioState"),"getIncomingClientAudioState",e)},e.toggleIncomingClientAudio=function(e){if(!e)throw new Error("[toggle incoming client audio] Callback cannot be null");Ze(Ue,de.sidePanel,de.meetingStage),vn(i(ci,"meeting.toggleIncomingClientAudio"),"toggleIncomingClientAudio",e)},e.getMeetingDetails=function(e){if(!e)throw new Error("[get meeting details] Callback cannot be null");Ze(Ue,de.sidePanel,de.meetingStage,de.settings,de.content),vn(i(ci,"meeting.getMeetingDetails"),"meeting.getMeetingDetails",e)},e.getMeetingDetailsVerbose=function(){var e,t,n;return si(this,void 0,void 0,function*(){let a;Ze(Ue,de.sidePanel,de.meetingStage,de.settings,de.content);try{const e=!0;a=yield hn(i("v2","meeting.getMeetingDetailsVerbose"),"meeting.getMeetingDetails",e)}catch(t){throw new Error(null===(e=null==t?void 0:t.errorCode)||void 0===e?void 0:e.toString())}if(((null===(t=a.details)||void 0===t?void 0:t.type)==r.GroupCall||(null===(n=a.details)||void 0===n?void 0:n.type)==r.OneOnOneCall)&&!a.details.originalCaller)throw new Error(ie.NOT_SUPPORTED_ON_PLATFORM.toString());return a})},e.getAuthenticationTokenForAnonymousUser=function(e){if(!e)throw new Error("[get Authentication Token For AnonymousUser] Callback cannot be null");Ze(Ue,de.sidePanel,de.meetingStage,de.task),vn(i(ci,"meeting.getAuthenticationTokenForAnonymousUser"),"meeting.getAuthenticationTokenForAnonymousUser",e)},e.getLiveStreamState=function(e){if(!e)throw new Error("[get live stream state] Callback cannot be null");Ze(Ue,de.sidePanel),vn(i(ci,"meeting.getLiveStreamState"),"meeting.getLiveStreamState",e)},e.requestStartLiveStreaming=function(e,t,n){if(!e)throw new Error("[request start live streaming] Callback cannot be null");Ze(Ue,de.sidePanel),vn(i(ci,"meeting.requestStartLiveStreaming"),"meeting.requestStartLiveStreaming",[t,n],e)},e.requestStopLiveStreaming=function(e){if(!e)throw new Error("[request stop live streaming] Callback cannot be null");Ze(Ue,de.sidePanel),vn(i(ci,"meeting.requestStopLiveStreaming"),"meeting.requestStopLiveStreaming",e)},e.registerLiveStreamChangedHandler=function(e){if(!e)throw new Error("[register live stream changed handler] Handler cannot be null");Ze(Ue,de.sidePanel),Yt(i(ci,"meeting.registerLiveStreamChangedHandler"),"meeting.liveStreamChanged",e)},e.shareAppContentToStage=function(e,t,n={sharingProtocol:o.Collaborative}){if(!e)throw new Error("[share app content to stage] Callback cannot be null");Ze(Ue,de.sidePanel,de.meetingStage),vn(i(ci,"meeting.shareAppContentToStage"),"meeting.shareAppContentToStage",[t,n],e)},e.getAppContentStageSharingCapabilities=function(e){if(!e)throw new Error("[get app content stage sharing capabilities] Callback cannot be null");Ze(Ue,de.sidePanel,de.meetingStage),vn(i(ci,"meeting.getAppContentStageSharingCapabilities"),"meeting.getAppContentStageSharingCapabilities",e)},e.stopSharingAppContentToStage=function(e){if(!e)throw new Error("[stop sharing app content to stage] Callback cannot be null");Ze(Ue,de.sidePanel,de.meetingStage),vn(i(ci,"meeting.stopSharingAppContentToStage"),"meeting.stopSharingAppContentToStage",e)},e.getAppContentStageSharingState=function(e){if(!e)throw new Error("[get app content stage sharing state] Callback cannot be null");Ze(Ue,de.sidePanel,de.meetingStage),vn(i(ci,"meeting.getAppContentStageSharingState"),"meeting.getAppContentStageSharingState",e)},e.registerSpeakingStateChangeHandler=function(e){if(!e)throw new Error("[registerSpeakingStateChangeHandler] Handler cannot be null");Ze(Ue,de.sidePanel,de.meetingStage),Yt(i(ci,"meeting.registerSpeakingStateChangeHandler"),"meeting.speakingStateChanged",e)},e.registerRaiseHandStateChangedHandler=function(e){if(!e)throw new Error("[registerRaiseHandStateChangedHandler] Handler cannot be null");Ze(Ue,de.sidePanel,de.meetingStage),Yt(i(ci,"meeting.registerRaiseHandStateChangedHandler"),"meeting.raiseHandStateChanged",e)},e.registerMeetingReactionReceivedHandler=function(e){if(!e)throw new Error("[registerMeetingReactionReceivedHandler] Handler cannot be null");Ze(Ue,de.sidePanel,de.meetingStage),Yt(i(ci,"meeting.registerMeetingReactionReceivedHandler"),"meeting.meetingReactionReceived",e)},e.joinMeeting=function(e){if(void 0===(null==e?void 0:e.joinWebUrl)||null===(null==e?void 0:e.joinWebUrl))return Promise.reject(new Error("Invalid joinMeetingParams"));Ze(Ue);const t={joinWebUrl:e.joinWebUrl.href,source:e.source||s.Other};return hn(i("v2","meeting.joinMeeting"),"meeting.joinMeeting",t)},function(e){e.M365CalendarGridContextMenu="m365_calendar_grid_context_menu",e.M365CalendarGridPeek="m365_calendar_grid_peek",e.M365CalendarGridEventCardJoinButton="m365_calendar_grid_event_card_join_button",e.M365CalendarFormRibbonJoinButton="m365_calendar_form_ribbon_join_button",e.M365CalendarFormJoinTeamsMeetingButton="m365_calendar_form_join_teams_meeting_button",e.Other="other"}(s=e.EventActionSource||(e.EventActionSource={})),function(e){e.setOptions=function(e){Ze(Ue,de.sidePanel),e.contentUrl&&new URL(e.contentUrl),vn(i(ci,"meeting.appShareButton.setOptions"),"meeting.appShareButton.setOptions",[e])}}(c=e.appShareButton||(e.appShareButton={})),e.requestAppAudioHandling=function(e,t){if(!t)throw new Error("[requestAppAudioHandling] Callback response cannot be null");if(!e.micMuteStateChangedCallback)throw new Error("[requestAppAudioHandling] Callback Mic mute state handler cannot be null");Ze(Ue,de.sidePanel,de.meetingStage),e.isAppHandlingAudio?d(e,t):function(e,t){vn(i(ci,"meeting.requestAppAudioHandling"),"meeting.requestAppAudioHandling",[e.isAppHandlingAudio],(e,n)=>{if(e&&null!=n)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(e)throw new Error(`[requestAppAudioHandling] Callback response - SDK error ${e.errorCode} ${e.message}`);if("boolean"!=typeof n)throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");Xt("meeting.micStateChanged")&&Jt("meeting.micStateChanged"),Xt("meeting.audioDeviceSelectionChanged")&&Jt("meeting.audioDeviceSelectionChanged"),t(n)})}(e,t)},e.updateMicState=function(e){l(e,t.AppInitiated)}}(di||(di={})),function(e){function t(){return!(!Ze(Ue)||!Ue.supports.monetization)}e.openPurchaseExperience=function(e,n){let a,r,o="";return"function"==typeof e?(a=e,r=n,o=i("v1","monetization.openPurchaseExperience")):(r=e,o=i("v2","monetization.openPurchaseExperience")),Ze(Ue,de.content),function(e,t,...n){const a=e();return a.then(e=>{t&&t(null,e)}).catch(e=>{t&&t(e,null)}),a}(()=>new Promise(e=>{if(!t())throw _e;e(hn(o,"monetization.openPurchaseExperience",r))}),a)},e.isSupported=t}(li||(li={})),function(e){function t(){return!(!Ze(Ue)||!Ue.supports.calendar)}e.openCalendarItem=function(e){return new Promise(n=>{if(Ze(Ue,de.content),!t())throw new Error("Not supported");if(!e.itemId||!e.itemId.trim())throw new Error("Must supply an itemId to openCalendarItem");n(mn(i("v2","calendar.openCalendarItem"),"calendar.openCalendarItem",e))})},e.composeMeeting=function(e){return new Promise(n=>{if(Ze(Ue,de.content),!t())throw new Error("Not supported");const a=i("v2","calendar.composeMeeting");Ue.isLegacyTeams?n(mn(a,"executeDeepLink",function(e,t,n,a,i){const r=void 0===e?"":"attendees="+e.map(e=>encodeURIComponent(e)).join(","),o=void 0===t?"":`&startTime=${encodeURIComponent(t)}`,s=void 0===n?"":`&endTime=${encodeURIComponent(n)}`,c=void 0===a?"":`&subject=${encodeURIComponent(a)}`,d=void 0===i?"":`&content=${encodeURIComponent(i)}`;return`${m}://${_}/l/meeting/new?${r}${o}${s}${c}${d}`}(e.attendees,e.startTime,e.endTime,e.subject,e.content))):n(mn(a,"calendar.composeMeeting",e))})},e.isSupported=t}(ui||(ui={})),function(e){function t(){return!(!Ze(Ue)||!Ue.supports.mail)}let n;e.openMailItem=function(e){return new Promise(n=>{if(Ze(Ue,de.content),!t())throw new Error("Not supported");if(!e.itemId||!e.itemId.trim())throw new Error("Must supply an itemId to openMailItem");n(mn(i("v2","mail.openMailItem"),"mail.openMailItem",e))})},e.composeMail=function(e){return new Promise(n=>{if(Ze(Ue,de.content),!t())throw new Error("Not supported");n(mn(i("v2","mail.composeMail"),"mail.composeMail",e))})},e.isSupported=t,function(e){e.New="new",e.Reply="reply",e.ReplyAll="replyAll",e.Forward="forward"}(n=e.ComposeMailType||(e.ComposeMailType={}))}(fi||(fi={})),function(e){function t(){Oe().print()}function n(e,t,n){!tt(t)&&Ze(Ue),!tt(t)&&n&&n(),function(e,t){Wt.loadHandler=t,!tt(t)&&vn(e,"registerHandler",["load"])}(e,t)}function a(e,t,n){!tt(t)&&Ze(Ue),!tt(t)&&n&&n(),function(e,t){Wt.beforeUnloadHandler=t,!tt(t)&&vn(e,"registerHandler",["beforeUnload"])}(e,t)}function r(){return!(!Ze(Ue)||!Ue.supports.teamsCore)}e.enablePrintCapability=function(){if(!b.printCapabilityEnabled){if(Ze(Ue),!r())throw _e;b.printCapabilityEnabled=!0,document.addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&80===e.keyCode&&(t(),e.cancelBubble=!0,e.preventDefault(),e.stopImmediatePropagation())})}},e.print=t,e.registerOnLoadHandler=function(e){n(i("v2","teamsAPIs_registerOnLoadHandler"),e,()=>{if(!tt(e)&&!r())throw _e})},e.registerOnLoadHandlerHelper=n,e.registerBeforeUnloadHandler=function(e){a(i("v2","teamsAPIs_registerBeforeUnloadHandler"),e,()=>{if(!tt(e)&&!r())throw _e})},e.registerBeforeUnloadHandlerHelper=a,e.isSupported=r}(pi||(pi={})),function(e){function t(e,t){return new Promise(a=>{if(!$e("2.0.0"))throw{errorCode:ie.OLD_PLATFORM};if(!function(e){if(e){if(e.title&&"string"!=typeof e.title)return!1;if(e.setSelected&&"object"!=typeof e.setSelected)return!1;if(e.openOrgWideSearchInChatOrChannel&&"boolean"!=typeof e.openOrgWideSearchInChatOrChannel)return!1;if(e.singleSelect&&"boolean"!=typeof e.singleSelect)return!1}return!0}(t))throw{errorCode:ie.INVALID_ARGUMENTS};if(!n())throw _e;a(hn(e,"people.selectPeople",t))})}function n(){return!(!Ze(Ue)||!Ue.supports.people)}e.selectPeople=function(e,n){let a,r;Ze(Ue,de.content,de.task,de.settings);let o="";return"function"==typeof e?([a,r]=[e,n],o=i("v1","people.selectPeople")):(r=e,o=i("v2","people.selectPeople")),function(e,t,...n){const a=e(...n);return a.then(e=>{t&&t(void 0,e)}).catch(e=>{t&&t(e)}),a}(t,a,o,r)},e.isSupported=n}(mi||(mi={})),function(e){e.showProfile=function(e){return Ze(Ue,de.content),new Promise(t=>{const[n,a]=function(e){return e?e.modality&&"string"!=typeof e.modality?[!1,"modality must be a string"]:e.targetElementBoundingRect&&"object"==typeof e.targetElementBoundingRect?e.triggerType&&"string"==typeof e.triggerType?function(e){return e?e.displayName&&"string"!=typeof e.displayName?[!1,"displayName must be a string"]:e.identifiers&&"object"==typeof e.identifiers?e.identifiers.AadObjectId||e.identifiers.Smtp||e.identifiers.Upn?e.identifiers.AadObjectId&&"string"!=typeof e.identifiers.AadObjectId?[!1,"AadObjectId identifier must be a string"]:e.identifiers.Smtp&&"string"!=typeof e.identifiers.Smtp?[!1,"Smtp identifier must be a string"]:e.identifiers.Upn&&"string"!=typeof e.identifiers.Upn?[!1,"Upn identifier must be a string"]:[!0,void 0]:[!1,"at least one valid identifier must be provided"]:[!1,"persona identifiers object must be provided"]:[!1,"persona object must be provided"]}(e.persona):[!1,"triggerType must be a valid string"]:[!1,"targetElementBoundingRect must be a DOMRect"]:[!1,"A request object is required"]}(e);if(!n)throw{errorCode:ie.INVALID_ARGUMENTS,message:a};const r={modality:e.modality,persona:e.persona,triggerType:e.triggerType,targetRectangle:{x:e.targetElementBoundingRect.x,y:e.targetElementBoundingRect.y,width:e.targetElementBoundingRect.width,height:e.targetElementBoundingRect.height}};t(hn(i("v2","profile.showProfile"),"profile.showProfile",r))})},e.isSupported=function(){return!(!Ze(Ue)||!Ue.supports.profile)}}(_i||(_i={}));const hi="v2";var bi,gi,vi;!function(e){const t="search.queryChange",n="search.queryClose",a="search.queryExecute";function r(){return!(!Ze(Ue)||!Ue.supports.search)}e.registerHandlers=function(e,o,s){if(Ze(Ue,de.content),!r())throw _e;Yt(i(hi,"search.registerOnClosedHandler"),n,e),Yt(i(hi,"search.registerOnExecutedHandler"),a,o),s&&Yt(i(hi,"search.registerOnChangeHandler"),t,s)},e.unregisterHandlers=function(){if(Ze(Ue,de.content),!r())throw _e;vn(i(hi,"search.unregisterHandlers"),"search.unregister"),Jt(t),Jt(n),Jt(a)},e.isSupported=r,e.closeSearch=function(){return new Promise(e=>{if(Ze(Ue,de.content),!r())throw new Error("Not supported");e(mn(i(hi,"search.closeSearch"),"search.closeSearch"))})}}(bi||(bi={})),function(e){function t(t,a){return new Promise(i=>{if(!n())throw _e;i(hn(t,e.SharingAPIMessages.shareWebContent,a))})}function n(){return!(!Ze(Ue)||!Ue.supports.sharing)}let a;e.SharingAPIMessages={shareWebContent:"sharing.shareWebContent"},e.shareWebContent=function(e,n){try{(function(e){if(!(e&&e.content&&e.content.length))throw{errorCode:ie.INVALID_ARGUMENTS,message:"Shared content is missing"}})(e),function(e){let t;if(e.content.some(e=>!e.type))throw t={errorCode:ie.INVALID_ARGUMENTS,message:"Shared content type cannot be undefined"},t;if(e.content.some(t=>t.type!==e.content[0].type))throw t={errorCode:ie.INVALID_ARGUMENTS,message:"Shared content must be of the same type"},t}(e),function(e){let t;if("URL"!==e.content[0].type)throw t={errorCode:ie.INVALID_ARGUMENTS,message:"Content type is unsupported"},t;if(e.content.some(e=>!e.url))throw t={errorCode:ie.INVALID_ARGUMENTS,message:"URLs are required for URL content types"},t}(e)}catch(e){return Ie(()=>Promise.reject(e),n)}return Ze(Ue,de.content,de.sidePanel,de.task,de.stage,de.meetingStage),Ie(t,n,i(n?"v1":"v2","sharing.shareWebContent"),e)},e.isSupported=n,function(e){function t(){var e;return Ze(Ue)&&void 0!==(null===(e=Ue.supports.sharing)||void 0===e?void 0:e.history)}e.getContent=function(){return function(e,t,n,a){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(t,n){function r(e){try{s(a.next(e))}catch(e){n(e)}}function o(e){try{s(a.throw(e))}catch(e){n(e)}}function s(e){e.done?t(e.value):i(e.value).then(r,o)}s((a=a.apply(e,[])).next())})}(this,0,void 0,function*(){if(Ze(Ue,de.sidePanel,de.meetingStage),!t())throw _e;const e=yield hn(i("v2","sharing.history.getContent"),"sharing.history.getContent");return e.map(e=>{Me(e.author),Me(e.threadId)}),e})},e.isSupported=t}(a=e.history||(e.history={}))}(gi||(gi={})),function(e){let t;function n(){return!(!Ze(Ue)||!Ue.supports.stageView)}!function(e){e.modal="modal",e.popout="popout",e.popoutWithChat="popoutWithChat"}(t=e.StageViewOpenMode||(e.StageViewOpenMode={})),e.open=function(e){return new Promise(t=>{if(Ze(Ue,de.content),!n())throw _e;if(!e)throw new Error("[stageView.open] Stage view params cannot be null");t(hn(i("v2","stageView.open"),"stageView.open",e))})},e.isSupported=n}(vi||(vi={}));var yi=function(e,t,n,a){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((a=a.apply(e,t||[])).next())})};const Si="v2";var Di,Ii,xi;!function(e){let t,n,a;!function(e){e[e.FrontOrRear=1]="FrontOrRear",e[e.FrontOnly=2]="FrontOnly",e[e.RearOnly=3]="RearOnly"}(t=e.CameraRestriction||(e.CameraRestriction={})),function(e){e[e.Camera=1]="Camera",e[e.Gallery=2]="Gallery"}(n=e.Source||(e.Source={})),e.hasPermission=function(){if(Ze(Ue,de.content,de.task),!a.isSupported())throw _e;const e=re.Media;return hn(i(Si,"visualMedia.hasPermission"),"permissions.has",e)},e.requestPermission=function(){if(Ze(Ue,de.content,de.task),!a.isSupported())throw _e;const e=re.Media;return hn(i(Si,"visualMedia.requestPermission"),"permissions.request",e)},function(e){function t(){return!!(Ze(Ue)&&Ue.supports.visualMedia&&Ue.supports.visualMedia.image&&Ue.supports.permissions)}function n(){if(!t())throw _e}function a(e){if(!e||e.maxVisualMediaCount>10||e.maxVisualMediaCount<1)throw be}function r(e,t){if(t.length>e)throw ge}e.captureImages=function(e){return yi(this,void 0,void 0,function*(){Ze(Ue,de.content,de.task),n(),a(e);const t=yield hn(i(Si,"visualMedia.image.captureImages"),"visualMedia.image.captureImages",e);return r(e.maxVisualMediaCount,t),t})},e.retrieveImages=function(e){return yi(this,void 0,void 0,function*(){Ze(Ue,de.content,de.task),n(),a(e);const t=yield hn(i(Si,"visualMedia.image.retrieveImages"),"visualMedia.image.retrieveImages",e);return r(e.maxVisualMediaCount,t),t})},e.isSupported=t}(a=e.image||(e.image={}))}(Di||(Di={})),function(e){function t(){return Ze(Ue)&&void 0!==Ue.supports.webStorage}e.isWebStorageClearedOnUserLogOut=function(){return function(e,t,n,a){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(t,n){function r(e){try{s(a.next(e))}catch(e){n(e)}}function o(e){try{s(a.throw(e))}catch(e){n(e)}}function s(e){e.done?t(e.value):i(e.value).then(r,o)}s((a=a.apply(e,[])).next())})}(this,0,void 0,function*(){if(Ze(Ue),!t())throw _e;return yield pn(i("v2","webStorage.isWebStorageClearedOnUserLogOut"),"webStorage.isWebStorageClearedOnUserLogOut")})},e.isSupported=t}(Ii||(Ii={})),function(e){let t;function n(){return!(!Ze(Ue)||!Ue.supports.call)}!function(e){e.Unknown="unknown",e.Audio="audio",e.Video="video",e.VideoBasedScreenSharing="videoBasedScreenSharing",e.Data="data"}(t=e.CallModalities||(e.CallModalities={})),e.startCall=function(e){const a=i("v2","call.startCall");return new Promise(i=>{var r;if(Ze(Ue,de.content,de.task),!n())throw _e;if(!Ue.isLegacyTeams)return vn(a,"call.startCall",[e],i);i(pn(a,"executeDeepLink",function(e,t,n){if(0===e.length)throw new Error("Must have at least one target when creating a call deep link");const a="users="+e.map(e=>encodeURIComponent(e)).join(","),i=void 0===t?"":`&withVideo=${encodeURIComponent(t)}`,r=void 0===n?"":`&source=${encodeURIComponent(n)}`;return`${m}://${_}/l/call/0/0?${a}${i}${r}`}(e.targets,null===(r=e.requestedModalities)||void 0===r?void 0:r.includes(t.Video),e.source)).then(e=>{if(!e)throw new Error("The call was not properly started");return e}))})},e.isSupported=n}(xi||(xi={}));const Ci="v1";var Oi;!function(e){e.Messages=kt.Messages,e.FailedReason=kt.FailedReason,e.ExpectedFailureReason=kt.ExpectedFailureReason,e.notifyAppLoaded=function(){xt(i(Ci,"appInitialization.notifyAppLoaded"))},e.notifySuccess=function(){wt(i(Ci,"appInitialization.notifySuccess"))},e.notifyFailure=function(e){Ot(i(Ci,"appInitialization.notifyFailure"),e)},e.notifyExpectedFailure=function(e){Ct(i(Ci,"appInitialization.notifyExpectedFailure"),e)}}(Oi||(Oi={}));const wi=t("thirdPartyCloudStorage");var Ei;!function(e){class t{constructor(e,t){this.fileType=e,this.assembleAttachment=t}}let n=[],a=null,r=!0,o=null;function s(e){if(o)if(e&&e.error)o([],e.error),o=null;else if(e&&e.fileChunk)try{r||0!==e.fileChunk.chunkSequence||(wi("Last chunk is not received or 'endOfFile' value for previous chunk was not set to true"),r=!0,o([],{errorCode:ie.INTERNAL_ERROR,message:"error occurred while receiving data"}),n=[],o=null);const i=Ka(e.fileChunk,e.fileType);if(i?(a||(a=new t(e.fileType,[])),a.assembleAttachment.push(i)):(wi(`Received a null assemble attachment for when decoding chunk sequence ${e.fileChunk.chunkSequence}; not including the chunk in the assembled file.`),o?o([],{errorCode:ie.INTERNAL_ERROR,message:"error occurred while receiving data"}):o=null,n=[],o=null,r=!0),r=e.fileChunk.endOfFile,e.fileChunk.endOfFile&&a){const t=Ga(a.assembleAttachment,a.fileType);if(t){const a=new File([t],e.fileName,{type:t.type});n.push(a)}e.isLastFile&&o&&(o(n,e.error),n=[],o=null,r=!0),a=null}}catch(e){o&&(o([],{errorCode:ie.INTERNAL_ERROR,message:e}),n=[],o=null,r=!0)}else o([],{errorCode:ie.INTERNAL_ERROR,message:"data received is null"}),n=[],o=null,r=!0}function c(){return!(!Ze(Ue)||!Ue.supports.thirdPartyCloudStorage)}e.getDragAndDropFiles=function(e,t){if(!t)throw new Error("[getDragAndDropFiles] Callback cannot be null");if(e&&""!==e){if(Ze(Ue,de.content,de.task),!c())throw _e;if(o)throw o=null,new Error("getDragAndDropFiles cannot be called twice");o=t,r=!0,vn(i("v2","thirdPartyCloudStorage.getDragAndDropFiles"),"thirdPartyCloudStorage.getDragAndDropFiles",[e],s)}else t([],{errorCode:ie.INVALID_ARGUMENTS})},e.isSupported=c}(Ei||(Ei={}));const Ai="v1";function Li(e,t){It(i(Ai,"initialize"),t).then(()=>{e&&e()})}function ki(){pi.enablePrintCapability()}function Mi(){pi.print()}function Pi(e){Xe(),vn(i(Ai,"getContext"),"getContext",t=>{t.frameContext||(t.frameContext=b.frameContext),e(t)})}function Ti(e){At(i(Ai,"registerOnThemeChangeHandlerHelper"),e)}function Ui(e){Zt(i(Ai,"registerFullScreenHandler"),"fullScreenChange",e,[])}function Fi(e){Zt(i(Ai,"registerAppButtonClickHandler"),"appButtonClick",e,[de.content])}function Hi(e){Zt(i(Ai,"registerAppButtonHoverEnterHandler"),"appButtonHoverEnter",e,[de.content])}function Ri(e){Zt(i(Ai,"registerAppButtonHoverLeaveHandler"),"appButtonHoverLeave",e,[de.content])}function Ni(e){Gt.backStack.registerBackButtonHandlerHelper(i(Ai,"registerBackButtonHandler"),e)}function Bi(e){pi.registerOnLoadHandlerHelper(i(Ai,"registerOnLoadHandler"),e)}function ji(e){pi.registerBeforeUnloadHandlerHelper(i(Ai,"registerBeforeUnloadHandler"),e)}function Vi(e){Zt(i(Ai,"registerFocusEnterHandler"),"focusEnter",e,[])}function zi(e){Zt(i(Ai,"registerChangeSettingsHandler"),"changeSettings",e,[de.content])}function Gi(e,t){Ze(Ue),Ht(i(Ai,"getTabInstances"),t).then(t=>{e(t)})}function Ki(e,t){Ze(Ue),Rt(i(Ai,"getMruTabInstances"),t).then(t=>{e(t)})}function Wi(e){Nt(i(Ai,"shareDeepLink"),{subPageId:e.subEntityId,subPageLabel:e.subEntityLabel,subPageWebUrl:e.subEntityWebUrl})}function qi(e,t){Ze(Ue,de.content,de.sidePanel,de.settings,de.task,de.stage,de.meetingStage);const n=null!=t?t:ve();Lt(i(Ai,"executeDeepLink"),e).then(()=>{n(!0)}).catch(e=>{n(!1,e.message)})}function Qi(e){Bt(i(Ai,"setFrameContext"),e)}function Yi(e,t,n){It(i(Ai,"initializeWithFrameContext"),n).then(()=>t&&t()),Bt(i(Ai,"setFrameContext"),e)}const Ji="v1";function Xi(e){Ft(i(Ji,"navigation.returnFocus"),e)}function Zi(e,t){Ze(Ue);const n=null!=t?t:ve();Ut(i(Ji,"navigation.navigateToTab"),e).then(()=>{n(!0)}).catch(e=>{n(!1,e.message)})}function $i(e,t){Ze(Ue,de.content,de.sidePanel,de.settings,de.remove,de.task,de.stage,de.meetingStage);const n=null!=t?t:ve();Pt(i(Ji,"navigation.navigateCrossDomain"),e).then(()=>{n(!0)}).catch(e=>{n(!1,e.message)})}function er(e){Ze(Ue);const t=null!=e?e:ve();Tt(i(Ji,"navigation.navigateBack")).then(()=>{t(!0)}).catch(e=>{t(!1,e.message)})}const tr="v1";var nr;!function(e){e.setValidityState=function(e){jt(i(tr,"settings.setValidityState"),e)},e.getSettings=function(e){Ze(Ue,de.content,de.settings,de.remove,de.sidePanel),Vt(i(tr,"settings.getSettings")).then(t=>{e(t)})},e.setSettings=function(e,t){Ze(Ue,de.content,de.settings,de.sidePanel);const n=null!=t?t:ve();zt(i(tr,"settings.setSettings"),e).then(()=>{n(!0)}).catch(e=>{n(!1,e.message)})},e.registerOnSaveHandler=function(e){Gt.config.registerOnSaveHandlerHelper(i(tr,"settings.registerOnSaveHandler"),e)},e.registerOnRemoveHandler=function(e){Gt.config.registerOnRemoveHandlerHelper(i(tr,"settings.registerOnRemoveHandler"),e)}}(nr||(nr={}));const ar="v1";var ir;!function(e){function t(e){return e.height=e.height?e.height:me.Small,e.width=e.width?e.width:me.Small,e}e.startTask=function(e,t){const n=i(ar,"tasks.startTask"),a=t?e=>{var n,a;return t(null!==(n=e.err)&&void 0!==n?n:"",null!==(a=e.result)&&void 0!==a?a:"")}:void 0;return void 0===e.card&&void 0===e.url||e.card?(Ze(Ue,de.content,de.sidePanel,de.meetingStage),vn(n,"tasks.startTask",[e],t)):void 0!==e.completionBotId?ht(n,function(e){if(void 0===e.url||void 0===e.completionBotId)throw new Error(`Both url ${e.url} and completionBotId ${e.completionBotId} are required for bot url dialog. At least one is undefined.`);return{url:e.url,size:{height:e.height?e.height:me.Small,width:e.width?e.width:me.Small},title:e.title,fallbackUrl:e.fallbackUrl,completionBotId:e.completionBotId}}(e),a):_t(n,function(e){if(void 0===e.url)throw new Error("url property of taskInfo object can't be undefined");return{url:e.url,size:{height:e.height?e.height:me.Small,width:e.width?e.width:me.Small},title:e.title,fallbackUrl:e.fallbackUrl}}(e),a),new ai},e.updateTask=function(e){e=t(e);const{width:n,height:a}=e,r=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(e,["width","height"]);if(Object.keys(r).length)throw new Error("resize requires a TaskInfo argument containing only width and height");mt(i(ar,"tasks.updateTask"),e)},e.submitTask=function(e,t){bt(i(ar,"tasks.submitTask"),e,t)},e.getDefaultSizeIfNotProvided=t}(ir||(ir={}));const rr="v2";var or;!function(e){let t,n;!function(e){e.guest="Guest",e.attendee="Attendee",e.presenter="Presenter",e.organizer="Organizer"}(t=e.UserMeetingRole||(e.UserMeetingRole={})),function(e){e.added="Added",e.alreadyExists="AlreadyExists",e.conflict="Conflict",e.notFound="NotFound"}(n=e.ContainerState||(e.ContainerState={})),e.isSupported=function(){return!(!Ze(Ue,de.meetingStage,de.sidePanel,de.content)||!Ue.supports.interactive)}}(or||(or={}));class sr{getFluidTenantInfo(){return cr(),new Promise(e=>{e(hn(i(rr,"interactive.getFluidTenantInfo"),"interactive.getFluidTenantInfo"))})}getFluidToken(e){return cr(),new Promise(t=>{t(hn(i(rr,"interactive.getFluidToken"),"interactive.getFluidToken",e))})}getFluidContainerId(){return cr(),new Promise(e=>{e(hn(i(rr,"interactive.getFluidContainerId"),"interactive.getFluidContainerId"))})}setFluidContainerId(e){return cr(),new Promise(t=>{t(hn(i(rr,"interactive.setFluidContainerId"),"interactive.setFluidContainerId",e))})}getNtpTime(){return cr(),new Promise(e=>{e(hn(i(rr,"interactive.getNtpTime"),"interactive.getNtpTime"))})}registerClientId(e){return cr(),new Promise(t=>{t(hn(i(rr,"interactive.registerClientId"),"interactive.registerClientId",e))})}getClientRoles(e){return cr(),new Promise(t=>{t(hn(i(rr,"interactive.getClientRoles"),"interactive.getClientRoles",e))})}getClientInfo(e){return cr(),new Promise(t=>{t(hn(i(rr,"interactive.getClientInfo"),"interactive.getClientInfo",e))})}static create(){return cr(),new sr}}function cr(){if(!or.isSupported())throw new Error("LiveShareHost Not supported")}function dr(e){try{return e.cartItems=lr(e.cartItems),e}catch(e){throw new Error("Error deserializing cart")}}function lr(e){return e.map(e=>{if(e.imageURL){const t=new URL(e.imageURL);e.imageURL=t}return e.accessories&&(e.accessories=lr(e.accessories)),e})}const ur=e=>{try{return e.map(e=>{const{imageURL:t,accessories:n}=e,a=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(e,["imageURL","accessories"]),i=Object.assign({},a);return t&&(i.imageURL=t.href),n&&(i.accessories=ur(n)),i})}catch(e){throw new Error("Error serializing cart items")}};function fr(e){if(null!=e){if(!Array.isArray(e)||0===e.length)throw new Error("CartItem.accessories must be a non-empty array");for(const t of e){if(t.accessories)throw new Error("Item in CartItem.accessories cannot have accessories");pr(t)}}}function pr(e){if(!e.id)throw new Error("cartItem.id must not be empty");if(!e.name)throw new Error("cartItem.name must not be empty");(function(e){if("number"!=typeof e||e<0)throw new Error(`price ${e} must be a number not less than 0`);if(parseFloat(e.toFixed(3))!==e)throw new Error(`price ${e} must have at most 3 decimal places`)})(e.price),function(e){if("number"!=typeof e||e<=0||parseInt(e.toString())!==e)throw new Error(`quantity ${e} must be an integer greater than 0`)}(e.quantity)}function mr(e){if(null!=e){if(!e)throw new Error("id must not be empty");if(!1===ee(e))throw new Error("id must be a valid UUID")}}const _r="v2";var hr;!function(e){let t,n;function a(){return!(!Ze(Ue)||!Ue.supports.marketplace)}e.cartVersion={majorVersion:1,minorVersion:1},function(e){e.TACAdminUser="TACAdminUser",e.TeamsAdminUser="TeamsAdminUser",e.TeamsEndUser="TeamsEndUser"}(t=e.Intent||(e.Intent={})),function(e){e.Open="Open",e.Processing="Processing",e.Processed="Processed",e.Closed="Closed",e.Error="Error"}(n=e.CartStatus||(e.CartStatus={})),e.getCart=function(){if(Ze(Ue,de.content,de.task),!a())throw _e;return hn(i(_r,"marketplace.getCart"),"marketplace.getCart",e.cartVersion).then(dr)},e.addOrUpdateCartItems=function(t){if(Ze(Ue,de.content,de.task),!a())throw _e;if(!t)throw new Error("addOrUpdateCartItemsParams must be provided");return mr(null==t?void 0:t.cartId),function(e){if(!Array.isArray(e)||0===e.length)throw new Error("cartItems must be a non-empty array");for(const t of e)pr(t),fr(t.accessories)}(null==t?void 0:t.cartItems),hn(i(_r,"marketplace.addOrUpdateCartItems"),"marketplace.addOrUpdateCartItems",Object.assign(Object.assign({},t),{cartItems:ur(t.cartItems),cartVersion:e.cartVersion})).then(dr)},e.removeCartItems=function(t){if(Ze(Ue,de.content,de.task),!a())throw _e;if(!t)throw new Error("removeCartItemsParams must be provided");if(mr(null==t?void 0:t.cartId),!Array.isArray(null==t?void 0:t.cartItemIds)||0===(null==t?void 0:t.cartItemIds.length))throw new Error("cartItemIds must be a non-empty array");return hn(i(_r,"marketplace.removeCartItems"),"marketplace.removeCartItems",Object.assign(Object.assign({},t),{cartVersion:e.cartVersion})).then(dr)},e.updateCartStatus=function(t){if(Ze(Ue,de.content,de.task),!a())throw _e;if(!t)throw new Error("updateCartStatusParams must be provided");return mr(null==t?void 0:t.cartId),function(e){if(!Object.values(hr.CartStatus).includes(e))throw new Error(`cartStatus ${e} is not valid`)}(null==t?void 0:t.cartStatus),hn(i(_r,"marketplace.updateCartStatus"),"marketplace.updateCartStatus",Object.assign(Object.assign({},t),{cartVersion:e.cartVersion})).then(dr)},e.isSupported=a}(hr||(hr={}))})(),a})(),e.exports=t()}
}]);