"use strict";(self["webpackJsonp_aec2bbfd-a968-4d5b-a279-12e570f378e6_1.20.0"]=self["webpackJsonp_aec2bbfd-a968-4d5b-a279-12e570f378e6_1.20.0"]||[]).push([[224],{963:(e,t,n)=>{n.r(t),n.d(t,{default:()=>l});var a=n(553),i=n(878),r=n(377),o=n(17),s=n(61);function c(){return i._SPKillSwitch.isActivated("cf20bd1c-8f94-466b-b394-382640c75c23")}var d=function(){function e(e,t,n){this._tokenProvider=e,this._graphBaseUrl=t,this._isInternal=n}return e.prototype.getAccessToken=function(){return this._isInternal?this._getInternalToken(this._tokenProvider):this._getOAuthToken(this._tokenProvider)},e.prototype._getOAuthToken=function(e){var t=new r._QosMonitor("MSGraphClient.FetchGraphToken");return e.getToken(this._graphBaseUrl).then(function(e){return t.writeSuccess(),e}).catch(function(e){throw t.writeUnexpectedFailure(e.message,e),e})},e.prototype._getInternalToken=function(e){var t=new r._QosMonitor("MSGraphClient.FetchInternalGraphToken");return e._getTokenInternal(this._graphBaseUrl,s._AadTokenProviders.preAuthorizedConfiguration).then(function(e){return t.writeSuccess(),e}).catch(function(e){throw t.writeUnexpectedFailure(e.message,e),e})},e}();const l=function(){function e(t,n,a,r){var o=this;this._isInternal=!1,t.whenFinished(function(){if(e._graphBaseUrl||(e._graphBaseUrl=t.consume(s._GraphHttpClientContext.serviceKey).getGraphEndpointUrl()),!c()){var d=t.consume(i._ClientManifestData.serviceKey);o._consumerComponentManifest=d.manifest}r?(o._isInternal=!0,e._internalInstance||(e._internalInstance=o._createInternalGraphClientInstance(s._AadTokenProviders.configurable,n))):e._instance||(e._instance=void 0!==a?o._createGraphClientInstanceWithMiddleware(s._AadTokenProviders.configurable,a):o._createGraphClientInstance(s._AadTokenProviders.configurable,n))})}return e.prototype.api=function(t){return i.Validate.isNonemptyString(t,"path"),this._isInternal?e._internalInstance.api(t):e._instance.api(t)},Object.defineProperty(e.prototype,"client",{get:function(){return this._isInternal?e._internalInstance:e._instance},enumerable:!1,configurable:!0}),e.prototype._createGraphClientInstance=function(e,t){var n,i=new r._QosMonitor("MSGraphClientV3.CreateGraphClientInstance");try{n=this._createClientInstance((0,a.__assign)((0,a.__assign)({},t),{authProvider:void 0}),e,!1)}catch(e){throw i.writeUnexpectedFailure(e.message,e),e}return n},e.prototype._createGraphClientInstanceWithMiddleware=function(e,t){var n,a=new r._QosMonitor("MSGraphClientV3.CreateGraphClientInstanceWithMiddleware");try{return n=this._createClientInstance(t,e,!1),a.writeSuccess(),n}catch(e){throw a.writeUnexpectedFailure(e.message,e),e}},e.prototype._createInternalGraphClientInstance=function(e,t){var n,i=new r._QosMonitor("MSGraphClientV3.CreateInternalGraphClientInstance");try{n=this._createClientInstance((0,a.__assign)((0,a.__assign)({},t),{authProvider:void 0}),e,!0)}catch(e){throw i.writeUnexpectedFailure(e.message,e),e}return n},e.prototype._createClientInstance=function(t,n,a){var i,r=t||{};if(r.baseUrl=e._graphBaseUrl,r.middleware?(i=[new o.AuthenticationHandler(new d(n,e._graphBaseUrl,a))],Array.isArray(r.middleware)?i.push.apply(i,r.middleware):i.push(r.middleware)):i=o.MiddlewareFactory.getDefaultMiddlewareChain(new d(n,e._graphBaseUrl,a)),!c()&&this._consumerComponentManifest){r.fetchOptions||(r.fetchOptions={}),r.fetchOptions.headers||(r.fetchOptions.headers={});var s="SPFx/".concat(this._consumerComponentManifest.alias,"/").concat(this._consumerComponentManifest.id,"/Is3PRequest:").concat(this._consumerComponentManifest.isInternal?"0":"1"),l=r.fetchOptions.headers;if(Array.isArray(l)){var u=l.findIndex(function(e){return"SdkVersion"===e[0]});-1===u?l.push(["SdkVersion",s]):l[u][1]+=", ".concat(s)}else l instanceof Headers?l.has("SdkVersion")?l.set("SdkVersion","".concat(l.get("SdkVersion"),", ").concat(s)):l.set("SdkVersion",s):l.SdkVersion=l.SdkVersions?"".concat(l.SdkVersion,", ").concat(s):s}return r.middleware=i,o.Client.initWithMiddleware(r)},e}()}
}]);